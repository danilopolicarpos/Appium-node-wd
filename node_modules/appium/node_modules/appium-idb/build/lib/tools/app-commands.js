"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

require("source-map-support/register");

var _logger = _interopRequireDefault(require("../logger.js"));

var _helpers = require("../helpers");

const appCommands = {};

appCommands.listApps = async function listApps() {
  _logger.default.debug(`Listing the info about installed apps on the device '${this.udid}'`);

  return (0, _helpers.fixOutputToArray)((await this.exec(['list-apps', '--json'])));
};

appCommands.installApp = async function installApp(appPath) {
  _logger.default.debug(`Installing '${appPath}' to the device '${this.udid}'`);

  await this.exec(['install', appPath]);
};

appCommands.launchApp = async function launchApp(bundleId, opts = {}) {
  const {
    failIfRunning = false,
    wait = false
  } = opts;

  _logger.default.debug(`Launching '${bundleId}' on the device '${this.udid}'`);

  const args = [];

  if (!failIfRunning) {
    args.push('--foreground-if-running');
  }

  if (!wait) {
    await this.exec(['launch', bundleId, ...args]);
    return null;
  }

  const processMonitor = this.createSubProcess(['launch', bundleId, ...args, '--wait-for']);
  await processMonitor.start(0);
  return processMonitor;
};

appCommands.terminateApp = async function terminateApp(bundleId) {
  _logger.default.debug(`Terminating '${bundleId}' on the device '${this.udid}'`);

  await this.exec(['terminate', bundleId]);
};

appCommands.uninstallApp = async function uninstallApp(bundleId) {
  _logger.default.debug(`Uninstalling '${bundleId}' from the device '${this.udid}'`);

  await this.exec(['uninstall', bundleId]);
};

var _default = appCommands;
exports.default = _default;require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi90b29scy9hcHAtY29tbWFuZHMuanMiXSwibmFtZXMiOlsiYXBwQ29tbWFuZHMiLCJsaXN0QXBwcyIsImxvZyIsImRlYnVnIiwidWRpZCIsImV4ZWMiLCJpbnN0YWxsQXBwIiwiYXBwUGF0aCIsImxhdW5jaEFwcCIsImJ1bmRsZUlkIiwib3B0cyIsImZhaWxJZlJ1bm5pbmciLCJ3YWl0IiwiYXJncyIsInB1c2giLCJwcm9jZXNzTW9uaXRvciIsImNyZWF0ZVN1YlByb2Nlc3MiLCJzdGFydCIsInRlcm1pbmF0ZUFwcCIsInVuaW5zdGFsbEFwcCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFFQSxNQUFNQSxXQUFXLEdBQUcsRUFBcEI7O0FBVUFBLFdBQVcsQ0FBQ0MsUUFBWixHQUF1QixlQUFlQSxRQUFmLEdBQTJCO0FBQ2hEQyxrQkFBSUMsS0FBSixDQUFXLHdEQUF1RCxLQUFLQyxJQUFLLEdBQTVFOztBQUNBLFNBQU8sZ0NBQWlCLE1BQU0sS0FBS0MsSUFBTCxDQUFVLENBQUMsV0FBRCxFQUFjLFFBQWQsQ0FBVixDQUF2QixFQUFQO0FBQ0QsQ0FIRDs7QUFVQUwsV0FBVyxDQUFDTSxVQUFaLEdBQXlCLGVBQWVBLFVBQWYsQ0FBMkJDLE9BQTNCLEVBQW9DO0FBQzNETCxrQkFBSUMsS0FBSixDQUFXLGVBQWNJLE9BQVEsb0JBQW1CLEtBQUtILElBQUssR0FBOUQ7O0FBQ0EsUUFBTSxLQUFLQyxJQUFMLENBQVUsQ0FBQyxTQUFELEVBQVlFLE9BQVosQ0FBVixDQUFOO0FBQ0QsQ0FIRDs7QUEwQkFQLFdBQVcsQ0FBQ1EsU0FBWixHQUF3QixlQUFlQSxTQUFmLENBQTBCQyxRQUExQixFQUFvQ0MsSUFBSSxHQUFHLEVBQTNDLEVBQStDO0FBQ3JFLFFBQU07QUFDSkMsSUFBQUEsYUFBYSxHQUFHLEtBRFo7QUFFSkMsSUFBQUEsSUFBSSxHQUFHO0FBRkgsTUFHRkYsSUFISjs7QUFJQVIsa0JBQUlDLEtBQUosQ0FBVyxjQUFhTSxRQUFTLG9CQUFtQixLQUFLTCxJQUFLLEdBQTlEOztBQUNBLFFBQU1TLElBQUksR0FBRyxFQUFiOztBQUNBLE1BQUksQ0FBQ0YsYUFBTCxFQUFvQjtBQUNsQkUsSUFBQUEsSUFBSSxDQUFDQyxJQUFMLENBQVUseUJBQVY7QUFDRDs7QUFDRCxNQUFJLENBQUNGLElBQUwsRUFBVztBQUNULFVBQU0sS0FBS1AsSUFBTCxDQUFVLENBQUMsUUFBRCxFQUFXSSxRQUFYLEVBQXFCLEdBQUdJLElBQXhCLENBQVYsQ0FBTjtBQUNBLFdBQU8sSUFBUDtBQUNEOztBQUVELFFBQU1FLGNBQWMsR0FBRyxLQUFLQyxnQkFBTCxDQUFzQixDQUMzQyxRQUQyQyxFQUNqQ1AsUUFEaUMsRUFFM0MsR0FBR0ksSUFGd0MsRUFFbEMsWUFGa0MsQ0FBdEIsQ0FBdkI7QUFJQSxRQUFNRSxjQUFjLENBQUNFLEtBQWYsQ0FBcUIsQ0FBckIsQ0FBTjtBQUNBLFNBQU9GLGNBQVA7QUFDRCxDQXJCRDs7QUE0QkFmLFdBQVcsQ0FBQ2tCLFlBQVosR0FBMkIsZUFBZUEsWUFBZixDQUE2QlQsUUFBN0IsRUFBdUM7QUFDaEVQLGtCQUFJQyxLQUFKLENBQVcsZ0JBQWVNLFFBQVMsb0JBQW1CLEtBQUtMLElBQUssR0FBaEU7O0FBQ0EsUUFBTSxLQUFLQyxJQUFMLENBQVUsQ0FBQyxXQUFELEVBQWNJLFFBQWQsQ0FBVixDQUFOO0FBQ0QsQ0FIRDs7QUFVQVQsV0FBVyxDQUFDbUIsWUFBWixHQUEyQixlQUFlQSxZQUFmLENBQTZCVixRQUE3QixFQUF1QztBQUNoRVAsa0JBQUlDLEtBQUosQ0FBVyxpQkFBZ0JNLFFBQVMsc0JBQXFCLEtBQUtMLElBQUssR0FBbkU7O0FBQ0EsUUFBTSxLQUFLQyxJQUFMLENBQVUsQ0FBQyxXQUFELEVBQWNJLFFBQWQsQ0FBVixDQUFOO0FBQ0QsQ0FIRDs7ZUFLZVQsVyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBsb2cgZnJvbSAnLi4vbG9nZ2VyLmpzJztcbmltcG9ydCB7IGZpeE91dHB1dFRvQXJyYXkgfSBmcm9tICcuLi9oZWxwZXJzJztcblxuY29uc3QgYXBwQ29tbWFuZHMgPSB7fTtcblxuLyoqXG4gKiBMaXN0cyB0aGUgdGFyZ2V0cyBpbnN0YWxsZWQgYXBwbGljYXRpb25zIGFuZCB0aGVpciBtZXRhZGF0YS5cbiAqIEV4YW1wbGUgb3V0cHV0OlxuICoge1wiYnVuZGxlX2lkXCI6IFwiY29tLmFwcGxlLnRlc3QuSW50ZWdyYXRpb25UZXN0c18xLVJ1bm5lclwiLCBcIm5hbWVcIjogXCJJbnRlZ3JhdGlvblRlc3RzXzEtUnVubmVyXCIsIFwiaW5zdGFsbF90eXBlXCI6IFwidXNlclwiLCBcImFyY2hpdGVjdHVyZXNcIjogW1wieDg2XzY0XCIsIFwiaTM4NlwiXSwgXCJwcm9jZXNzX3N0YXRlXCI6IFwiVW5rbm93blwiLCBcImRlYnVnZ2FibGVcIjogZmFsc2V9XG4gKiB7XCJidW5kbGVfaWRcIjogXCJjb20uYXBwbGUubW9iaWxlc2FmYXJpXCIsIFwibmFtZVwiOiBcIk1vYmlsZVNhZmFyaVwiLCBcImluc3RhbGxfdHlwZVwiOiBcInN5c3RlbVwiLCBcImFyY2hpdGVjdHVyZXNcIjogW1wieDg2XzY0XCJdLCBcInByb2Nlc3Nfc3RhdGVcIjogXCJVbmtub3duXCIsIFwiZGVidWdnYWJsZVwiOiBmYWxzZX1cbiAqXG4gKiBAcmV0dXJucyB7QXJyYXk8b2JqZWN0Pn1cbiAqL1xuYXBwQ29tbWFuZHMubGlzdEFwcHMgPSBhc3luYyBmdW5jdGlvbiBsaXN0QXBwcyAoKSB7XG4gIGxvZy5kZWJ1ZyhgTGlzdGluZyB0aGUgaW5mbyBhYm91dCBpbnN0YWxsZWQgYXBwcyBvbiB0aGUgZGV2aWNlICcke3RoaXMudWRpZH0nYCk7XG4gIHJldHVybiBmaXhPdXRwdXRUb0FycmF5KGF3YWl0IHRoaXMuZXhlYyhbJ2xpc3QtYXBwcycsICctLWpzb24nXSkpO1xufTtcblxuLyoqXG4gKiBJbnN0YWxscyB0aGUgZ2l2ZW4gYXBwbGljYXRpb24gdG8gdGhlIGRldmljZSB1bmRlciB0ZXN0LlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBhcHBQYXRoIEZ1bGwgcGF0aCB0byB0aGUgLmFwcCBvciAuaXBhXG4gKi9cbmFwcENvbW1hbmRzLmluc3RhbGxBcHAgPSBhc3luYyBmdW5jdGlvbiBpbnN0YWxsQXBwIChhcHBQYXRoKSB7XG4gIGxvZy5kZWJ1ZyhgSW5zdGFsbGluZyAnJHthcHBQYXRofScgdG8gdGhlIGRldmljZSAnJHt0aGlzLnVkaWR9J2ApO1xuICBhd2FpdCB0aGlzLmV4ZWMoWydpbnN0YWxsJywgYXBwUGF0aF0pO1xufTtcblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBMYXVuY2hPcHRpb25zXG4gKlxuICogQHByb3BlcnR5IHs/Ym9vbGVhbn0gZmFpbElmUnVubmluZyBbZmFsc2VdIC0gSWYgc2V0IHRvIHRydWUgdGhlblxuICogdGhlIG1ldGhvZCBjYWxsIHdpbGwgZmFpbCBpZiB0aGUgYXBwIHdpdGggdGhlIGdpdmVuIGJ1bmRsZSBpZCBpc1xuICogYWxyZWFkeSBydW5uaW5nXG4gKiBAcHJvcGVydHkgez9ib29sZWFufSB3YWl0IFtmYWxzZV0gLSBTZXQgaXQgdG8gdHJ1ZSBpZiBwcm9jZXNzXG4gKiBtb25pdG9yaW5nIGlzIG5lZWRlZC4gU2VlIHRoZSBkZXNjcmlwdGlvbiBvZiB0aGUgcmV0dXJuZWQgcmVzdWx0XG4gKiBmb3IgbW9yZSBkZXRhaWxzXG4gKi9cblxuLyoqXG4gKiBTdGFydHMgYW4gaW5zdGFsbGVkIGFwcCBvbiB0aGUgZGV2aWNlIHVuZGVyIHRlc3QuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGJ1bmRsZUlkIEJ1bmRsZSBpZGVudGlmaWVyIG9mIHRoZSBhcHBsaWNhdGlvbiB0byBsYXVuY2guXG4gKiBAcGFyYW0gez9MYXVuY2hPcHRpb25zfSBvcHRzXG4gKiBAcmV0dXJucyB7P1N1YlByb2Nlc3N9IElmIGBvcHRzLndhaXRgIGlzIHNldCB0byB0cnVlIHRoZW4gU3ViUHJvY2VzcyBpbnN0YW5jZVxuICogaXMgcmV0dXJuZWQsIHdoaWNoIHJlcHJlc2VudHMgdGhlIGV4ZWN1dGVkIHByb2Nlc3MgbW9uaXRvci4gVGhlIG1vbml0b3JcbiAqIHdpbGwgYmUgdGVybWluYXRlZCB3aGVuIHRoZSBsYXVuY2hlZCBpcyBjbG9zZWQuIHN0ZG91dCBhbmQgc3RkZXJyIG9mIHRoZVxuICogcmVtb3RlIHByb2Nlc3Mgd2lsbCBhbHNvIGJlIGZvcndhcmRlZC4gYG51bGxgIGlzIHJldHVybmVkIG90aGVyd2lzZS5cbiAqL1xuYXBwQ29tbWFuZHMubGF1bmNoQXBwID0gYXN5bmMgZnVuY3Rpb24gbGF1bmNoQXBwIChidW5kbGVJZCwgb3B0cyA9IHt9KSB7XG4gIGNvbnN0IHtcbiAgICBmYWlsSWZSdW5uaW5nID0gZmFsc2UsXG4gICAgd2FpdCA9IGZhbHNlLFxuICB9ID0gb3B0cztcbiAgbG9nLmRlYnVnKGBMYXVuY2hpbmcgJyR7YnVuZGxlSWR9JyBvbiB0aGUgZGV2aWNlICcke3RoaXMudWRpZH0nYCk7XG4gIGNvbnN0IGFyZ3MgPSBbXTtcbiAgaWYgKCFmYWlsSWZSdW5uaW5nKSB7XG4gICAgYXJncy5wdXNoKCctLWZvcmVncm91bmQtaWYtcnVubmluZycpO1xuICB9XG4gIGlmICghd2FpdCkge1xuICAgIGF3YWl0IHRoaXMuZXhlYyhbJ2xhdW5jaCcsIGJ1bmRsZUlkLCAuLi5hcmdzXSk7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBjb25zdCBwcm9jZXNzTW9uaXRvciA9IHRoaXMuY3JlYXRlU3ViUHJvY2VzcyhbXG4gICAgJ2xhdW5jaCcsIGJ1bmRsZUlkLFxuICAgIC4uLmFyZ3MsICctLXdhaXQtZm9yJyxcbiAgXSk7XG4gIGF3YWl0IHByb2Nlc3NNb25pdG9yLnN0YXJ0KDApO1xuICByZXR1cm4gcHJvY2Vzc01vbml0b3I7XG59O1xuXG4vKipcbiAqIEtpbGxzIGFuIGFwcCB3aXRoIHRoZSBnaXZlbiBidW5kbGUgSURcbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gYnVuZGxlSWQgQnVuZGxlIGlkZW50aWZpZXIgb2YgdGhlIGFwcGxpY2F0aW9uIHRvIHRlcm1pbmF0ZVxuICovXG5hcHBDb21tYW5kcy50ZXJtaW5hdGVBcHAgPSBhc3luYyBmdW5jdGlvbiB0ZXJtaW5hdGVBcHAgKGJ1bmRsZUlkKSB7XG4gIGxvZy5kZWJ1ZyhgVGVybWluYXRpbmcgJyR7YnVuZGxlSWR9JyBvbiB0aGUgZGV2aWNlICcke3RoaXMudWRpZH0nYCk7XG4gIGF3YWl0IHRoaXMuZXhlYyhbJ3Rlcm1pbmF0ZScsIGJ1bmRsZUlkXSk7XG59O1xuXG4vKipcbiAqIFVuaW5zdGFsbHMgYW4gYXBwIHdpdGggdGhlIGdpdmVuIGJ1bmRsZSBJRFxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBidW5kbGVJZCBCdW5kbGUgaWRlbnRpZmllciBvZiB0aGUgYXBwbGljYXRpb24gdG8gdW5pbnN0YWxsXG4gKi9cbmFwcENvbW1hbmRzLnVuaW5zdGFsbEFwcCA9IGFzeW5jIGZ1bmN0aW9uIHVuaW5zdGFsbEFwcCAoYnVuZGxlSWQpIHtcbiAgbG9nLmRlYnVnKGBVbmluc3RhbGxpbmcgJyR7YnVuZGxlSWR9JyBmcm9tIHRoZSBkZXZpY2UgJyR7dGhpcy51ZGlkfSdgKTtcbiAgYXdhaXQgdGhpcy5leGVjKFsndW5pbnN0YWxsJywgYnVuZGxlSWRdKTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGFwcENvbW1hbmRzO1xuIl0sImZpbGUiOiJsaWIvdG9vbHMvYXBwLWNvbW1hbmRzLmpzIiwic291cmNlUm9vdCI6Ii4uLy4uLy4uIn0=
