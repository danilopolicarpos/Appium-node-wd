"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.RPC_RESPONSE_TIMEOUT_MS = exports.REMOTE_DEBUGGER_PORT = exports.DEBUGGER_TYPES = exports.RemoteDebugger = void 0;

require("source-map-support/register");

var _events = _interopRequireDefault(require("events"));

var _logger = _interopRequireDefault(require("./logger"));

var _appiumBaseDriver = require("appium-base-driver");

var _remoteDebuggerRpcClient = _interopRequireDefault(require("./remote-debugger-rpc-client"));

var _messageHandlers = _interopRequireDefault(require("./message-handlers"));

var _helpers = require("./helpers");

var _appiumSupport = require("appium-support");

var _lodash = _interopRequireDefault(require("lodash"));

var _bluebird = _interopRequireDefault(require("bluebird"));

var _path = _interopRequireDefault(require("path"));

let VERSION;

try {
  VERSION = require(_path.default.resolve(__dirname, '..', '..', 'package.json')).version;
} catch (ign) {}

const DEBUGGER_TYPES = {
  webkit: 1,
  webinspector: 2
};
exports.DEBUGGER_TYPES = DEBUGGER_TYPES;
const SELECT_APP_RETRIES = 20;
const REMOTE_DEBUGGER_PORT = 27753;
exports.REMOTE_DEBUGGER_PORT = REMOTE_DEBUGGER_PORT;
const RPC_RESPONSE_TIMEOUT_MS = 5000;
exports.RPC_RESPONSE_TIMEOUT_MS = RPC_RESPONSE_TIMEOUT_MS;
const PAGE_READY_TIMEOUT = 5000;
const RESPONSE_LOG_LENGTH = 100;
const GARBAGE_COLLECT_TIMEOUT = 5000;

class RemoteDebugger extends _events.default.EventEmitter {
  constructor(opts = {}) {
    super();

    if (VERSION) {
      _logger.default.info(`Remote Debugger version ${VERSION}`);
    }

    const {
      bundleId,
      platformVersion,
      debuggerType = DEBUGGER_TYPES.webinspector,
      isSafari = true,
      useNewSafari = false,
      pageLoadMs,
      host,
      port = REMOTE_DEBUGGER_PORT,
      socketPath,
      pageReadyTimeout = PAGE_READY_TIMEOUT,
      remoteDebugProxy,
      garbageCollectOnExecute = false,
      logFullResponse = false
    } = opts;
    this.bundleId = bundleId;
    this.platformVersion = platformVersion;
    this.isSafari = isSafari;
    this.debuggerType = debuggerType;

    if (this.debuggerType === DEBUGGER_TYPES.webinspector) {
      this.useNewSafari = useNewSafari;
      this.pageLoadMs = pageLoadMs;

      _logger.default.debug(`useNewSafari --> ${this.useNewSafari}`);
    }

    this.garbageCollectOnExecute = garbageCollectOnExecute;
    this.host = host;
    this.port = port;
    this.socketPath = socketPath;
    this.remoteDebugProxy = remoteDebugProxy;
    this.pageReadyTimeout = pageReadyTimeout;
    this.logFullResponse = logFullResponse;
  }

  setup() {
    this.appDict = {};
    this.appIdKey = null;
    this.pageIdKey = null;
    this.pageLoading = false;
    this._navigatingToPage = false;
    this.specialCbs = {
      '_rpc_reportIdentifier:': _lodash.default.noop,
      '_rpc_forwardGetListing:': this.onPageChange.bind(this),
      '_rpc_reportConnectedApplicationList:': _lodash.default.noop,
      '_rpc_applicationConnected:': this.onAppConnect.bind(this),
      '_rpc_applicationDisconnected:': this.onAppDisconnect.bind(this),
      '_rpc_applicationUpdated:': this.onAppUpdate.bind(this),
      '_rpc_reportConnectedDriverList:': this.onReportDriverList.bind(this),
      pageLoad: this.pageLoad.bind(this),
      frameDetached: this.frameDetached.bind(this),
      targetCreated: this.onTargetCreated.bind(this),
      targetDestroyed: this.onTargetDestroyed.bind(this)
    };
    this.rpcClient = null;
  }

  teardown() {
    _logger.default.debug('Cleaning up listeners');

    this.appDict = {};
    this.appIdKey = null;
    this.pageIdKey = null;
    this.pageLoading = false;
    this.specialCbs = {};
    this.rpcClient = null;
    this.removeAllListeners(RemoteDebugger.EVENT_PAGE_CHANGE);
    this.removeAllListeners(RemoteDebugger.EVENT_DISCONNECT);
  }

  async connect() {
    this.setup();
    this.rpcClient = new _remoteDebuggerRpcClient.default({
      platformVersion: this.platformVersion,
      isSafari: this.isSafari,
      host: this.host,
      port: this.port,
      socketPath: this.socketPath,
      specialMessageHandlers: this.specialCbs,
      messageProxy: this.remoteDebugProxy,
      logFullResponse: this.logFullResponse
    });
    await this.rpcClient.connect();

    try {
      const appInfo = await this.setConnectionKey();

      _logger.default.debug('Connected to application');

      return appInfo;
    } catch (err) {
      await this.disconnect();
      return null;
    }
  }

  async disconnect() {
    await this.rpcClient.disconnect();
    this.emit(RemoteDebugger.EVENT_DISCONNECT, true);
    this.teardown();
  }

  isConnected() {
    return !!(this.rpcClient && this.rpcClient.isConnected());
  }

  async setConnectionKey() {
    return await new _bluebird.default((resolve, reject) => {
      let connectCb = apps => {
        if (_lodash.default.isUndefined(apps) || _lodash.default.keys(apps).length === 0) {
          _logger.default.debug('Received no apps from remote debugger. Unable to connect.');

          return resolve(this.appDict);
        }

        let newDict = {};

        for (const dict of _lodash.default.values(apps)) {
          let [id, entry] = (0, _helpers.appInfoFromDict)(dict);
          newDict[id] = entry;
        }

        _lodash.default.defaults(this.appDict, newDict);

        resolve(newDict);
      };

      this.rpcClient.setSpecialMessageHandler('_rpc_reportConnectedApplicationList:', reject, connectCb);

      _logger.default.debug('Sending connection key request');

      return (async () => {
        let [simNameKey, simBuildKey, simPlatformVersion] = await this.rpcClient.send('setConnectionKey');

        _logger.default.debug(`Sim name: ${simNameKey}`);

        _logger.default.debug(`Sim build: ${simBuildKey}`);

        _logger.default.debug(`Sim platform version: ${simPlatformVersion}`);
      })();
    });
  }

  updateAppsWithDict(dict) {
    this.appDict = this.appDict || {};
    let [id, entry] = (0, _helpers.appInfoFromDict)(dict);

    if (this.appDict[id]) {
      entry.pageArray = this.appDict[id].pageArray;
    }

    this.appDict[id] = entry;

    if (_lodash.default.isUndefined(entry.pageArray)) {
      entry.pageArray = (0, _helpers.deferredPromise)();
    }

    if (!this.appIdKey) {
      this.appIdKey = (0, _helpers.getDebuggerAppKey)(this.bundleId, this.platformVersion, this.appDict);
    }
  }

  logApplicationDictionary(apps) {
    function getValueString(key, value) {
      if (_lodash.default.isFunction(value)) {
        return '[Function]';
      }

      if (key === 'pageArray' && !_lodash.default.isArray(value)) {
        return `'Waiting for data'`;
      }

      return JSON.stringify(value);
    }

    _logger.default.debug('Current applications available:');

    for (const [app, info] of _lodash.default.toPairs(apps)) {
      _logger.default.debug(`    Application: '${app}'`);

      for (const [key, value] of _lodash.default.toPairs(info)) {
        if (key === 'pageArray' && Array.isArray(value) && value.length) {
          _logger.default.debug(`        ${key}:`);

          for (const page of value) {
            let prefix = '- ';

            for (const [k, v] of _lodash.default.toPairs(page)) {
              _logger.default.debug(`          ${prefix}${k}: ${JSON.stringify(v)}`);

              prefix = '  ';
            }
          }
        } else {
          const valueString = getValueString(key, value);

          _logger.default.debug(`        ${key}: ${valueString}`);
        }
      }
    }
  }

  async selectApp(currentUrl = null, maxTries = SELECT_APP_RETRIES, ignoreAboutBlankUrl = false) {
    _logger.default.debug('Selecting application');

    if (!this.appDict || _lodash.default.keys(this.appDict).length === 0) {
      _logger.default.debug('No applications currently connected.');

      return [];
    }

    let pageDict, appIdKey;

    appLoop: for (let i = 0; i < maxTries; i++) {
      this.logApplicationDictionary(this.appDict);
      let possibleAppIds = (0, _helpers.getPossibleDebuggerAppKeys)(this.bundleId, this.platformVersion, this.appDict);

      _logger.default.debug(`Trying out the possible app ids: ${possibleAppIds.join(', ')}`);

      for (const attemptedAppIdKey of possibleAppIds) {
        try {
          _logger.default.debug(`Selecting app ${attemptedAppIdKey} (try #${i + 1} of ${maxTries})`);

          [appIdKey, pageDict] = await this.rpcClient.selectApp(attemptedAppIdKey, this.onAppConnect.bind(this));

          if (_lodash.default.isEmpty(pageDict)) {
            _logger.default.debug('Empty page dictionary received. Trying again.');

            continue;
          }

          this.appDict[appIdKey].pageArray = (0, _helpers.pageArrayFromDict)(pageDict);
          let found = false;

          dictLoop: for (const appDict of _lodash.default.values(this.appDict)) {
            if (found) break;

            if (!appDict || !appDict.pageArray) {
              continue;
            }

            if (appDict.pageArray.promise) {
              try {
                await _bluebird.default.resolve(appDict.pageArray.promise).timeout(10000);
              } catch (err) {
                if (!(err instanceof _bluebird.default.TimeoutError)) {
                  throw err;
                }

                continue;
              }
            }

            for (const dict of appDict.pageArray || []) {
              if ((!ignoreAboutBlankUrl || dict.url !== 'about:blank') && (!currentUrl || dict.url === currentUrl || dict.url === `${currentUrl}/`)) {
                appIdKey = appDict.id;
                pageDict = dict;
                found = true;
                break dictLoop;
              }
            }
          }

          if (!found) {
            if (currentUrl) {
              _logger.default.debug(`Received app, but expected url ('${currentUrl}') was not found. Trying again.`);
            } else {
              _logger.default.debug('Received app, but no match was found. Trying again.');
            }

            pageDict = null;
            continue;
          }

          break appLoop;
        } catch (err) {
          _logger.default.debug(`Error checking application: '${err.message}'. Retrying connection`);
        }
      }
    }

    if (!pageDict) {
      _logger.default.errorAndThrow(`Could not connect to a valid app after ${maxTries} tries.`);
    }

    if (this.appIdKey !== appIdKey) {
      _logger.default.debug(`Received altered app id, updating from '${this.appIdKey}' to '${appIdKey}'`);

      this.appIdKey = appIdKey;
    }

    const pagePromises = Object.values(this.appDict).filter(app => !!app.pageArray && !!app.pageArray.promise).map(app => app.pageArray.promise);

    if (pagePromises.length) {
      _logger.default.debug(`Waiting for ${pagePromises.length} pages to be fulfilled`);

      await _bluebird.default.any([_bluebird.default.delay(30000), _bluebird.default.all(pagePromises)]);
    }

    this.logApplicationDictionary(this.appDict);
    const pageArray = _lodash.default.isEmpty(this.appDict[appIdKey].pageArray) ? (0, _helpers.pageArrayFromDict)(pageDict) : this.appDict[appIdKey].pageArray;

    _logger.default.debug(`Finally selecting app ${this.appIdKey}: ${(0, _helpers.simpleStringify)(pageArray)}`);

    let fullPageArray = [];

    for (const [app, info] of _lodash.default.toPairs(this.appDict)) {
      if (!_lodash.default.isArray(info.pageArray)) continue;
      let id = app.replace('PID:', '');

      for (const page of info.pageArray) {
        if (page.url && (!ignoreAboutBlankUrl || page.url !== 'about:blank') && (!currentUrl || page.url === currentUrl || page.url === `${currentUrl}/`)) {
          let pageDict = _lodash.default.clone(page);

          pageDict.id = `${id}.${pageDict.id}`;
          fullPageArray.push(pageDict);
        }
      }
    }

    return fullPageArray;
  }

  async selectPage(appIdKey, pageIdKey, skipReadyCheck = false) {
    this.appIdKey = `PID:${appIdKey}`;
    this.pageIdKey = pageIdKey;

    _logger.default.debug(`Selecting page '${pageIdKey}' on app '${this.appIdKey}' and forwarding socket setup`);

    await this.rpcClient.send('setSenderKey', {
      appIdKey: this.appIdKey,
      pageIdKey: this.pageIdKey
    });

    _logger.default.debug('Sender key set');

    this.rpcClient.shouldCheckForTarget = true;
    await this.rpcClient.send('enablePage', {
      appIdKey: this.appIdKey,
      pageIdKey: this.pageIdKey,
      debuggerType: this.debuggerType,
      targetId: 'page-1'
    });

    _logger.default.debug('Enabled activity on page');

    if (!skipReadyCheck && !(await this.checkPageIsReady())) {
      await this.pageUnload();
    }
  }

  async executeAtom(atom, args, frames) {
    if (!this.rpcClient.connected) throw new Error('Remote debugger is not connected');

    _logger.default.debug(`Executing atom '${atom}'`);

    const script = await (0, _helpers.getScriptForAtom)(atom, args, frames);
    const value = await this.execute(script, true);

    _logger.default.debug(`Received result for atom '${atom}' execution: ${_lodash.default.truncate((0, _helpers.simpleStringify)(value), {
      length: RESPONSE_LOG_LENGTH
    })}`);

    return value;
  }

  async executeAtomAsync(atom, args, frames, responseUrl) {
    let asyncCallBack = `function (res) { xmlHttp = new XMLHttpRequest(); ` + `xmlHttp.open('POST', '${responseUrl}', true);` + `xmlHttp.setRequestHeader('Content-type','application/json'); ` + `xmlHttp.send(res); }`;
    let script = await (0, _helpers.getScriptForAtom)(atom, args, frames, asyncCallBack);
    await this.execute(script);
  }

  frameDetached() {
    this.emit(RemoteDebugger.EVENT_FRAMES_DETACHED);
  }

  async pageLoad(startPageLoadMs, pageLoadVerifyHook) {
    let timeoutMs = 500;
    let start = startPageLoadMs || Date.now();

    _logger.default.debug('Page loaded, verifying whether ready');

    const verify = async () => {
      this.pageLoadDelay = _appiumSupport.util.cancellableDelay(timeoutMs);

      try {
        await this.pageLoadDelay;
      } catch (err) {
        if (err instanceof _bluebird.default.CancellationError) {
          return;
        }
      }

      if (!this.appIdKey) {
        _logger.default.debug('Not connected to an application. Ignoring page load');

        return;
      }

      if (_lodash.default.isFunction(pageLoadVerifyHook)) {
        await pageLoadVerifyHook();
      }

      const ready = await this.checkPageIsReady();

      if (ready || this.pageLoadMs > 0 && start + this.pageLoadMs < Date.now()) {
        _logger.default.debug('Page is ready');

        this.pageLoading = false;
      } else {
        _logger.default.debug('Page was not ready, retrying');

        await verify();
      }
    };

    await verify();
  }

  cancelPageLoad() {
    _logger.default.debug('Unregistering from page readiness notifications');

    this.pageLoading = false;

    if (this.pageLoadDelay) {
      this.pageLoadDelay.cancel();
    }
  }

  async pageUnload() {
    _logger.default.debug('Page unloading');

    this.pageLoading = true;
    await this.waitForDom();
  }

  async waitForDom(startPageLoadMs, pageLoadVerifyHook) {
    _logger.default.debug('Waiting for dom...');

    await this.pageLoad(startPageLoadMs, pageLoadVerifyHook);
  }

  async checkPageIsReady() {
    const errors = (0, _helpers.checkParams)({
      appIdKey: this.appIdKey
    });
    if (errors) throw new Error(errors);

    _logger.default.debug('Checking document readyState');

    const readyCmd = '(function (){ return document.readyState; })()';
    let readyState = 'loading';

    try {
      readyState = await _bluebird.default.resolve(this.execute(readyCmd, true)).timeout(this.pageReadyTimeout);
    } catch (err) {
      if (!(err instanceof _bluebird.default.TimeoutError)) {
        throw err;
      }

      _logger.default.debug(`Page readiness check timed out after ${this.pageReadyTimeout}ms`);

      return false;
    }

    _logger.default.debug(`Document readyState is '${readyState}'`);

    return readyState === 'complete';
  }

  async navToUrl(url, pageLoadVerifyHook) {
    if (this.debuggerType === DEBUGGER_TYPES.webinspector) {
      const errors = (0, _helpers.checkParams)({
        appIdKey: this.appIdKey,
        pageIdKey: this.pageIdKey
      });
      if (errors) throw new Error(errors);
    }

    this._navigatingToPage = true;

    try {
      _logger.default.debug(`Navigating to new URL: '${url}'`);

      await this.rpcClient.send('setUrl', {
        url,
        appIdKey: this.appIdKey,
        pageIdKey: this.pageIdKey,
        debuggerType: this.debuggerType
      });

      if (!this.useNewSafari) {
        await _bluebird.default.delay(1000);
      }

      if (this.debuggerType === DEBUGGER_TYPES.webinspector) {
        await this.waitForFrameNavigated();
      }

      await this.waitForDom(Date.now(), pageLoadVerifyHook);
    } finally {
      this._navigatingToPage = false;
    }
  }

  async waitForFrameNavigated() {
    return await new _bluebird.default(async (resolve, reject) => {
      _logger.default.debug('Waiting for frame navigated message...');

      let startMs = Date.now();

      let navEventListener = value => {
        _logger.default.debug(`Frame navigated in ${(Date.now() - startMs) / 1000} sec from source: ${value}`);

        if (this.navigationDelay) {
          this.navigationDelay.cancel();
        }

        resolve(value);
      };

      this.rpcClient.setSpecialMessageHandler('Page.frameNavigated', reject, navEventListener);

      if (!this.useNewSafari || this.pageLoadMs >= 0) {
        let timeout = this.useNewSafari ? this.pageLoadMs : 500;
        this.navigationDelay = _appiumSupport.util.cancellableDelay(timeout);

        try {
          await this.navigationDelay;
          navEventListener('timeout');
        } catch (err) {}
      }
    });
  }

  async startTimeline(fn) {
    _logger.default.debug('Starting to record the timeline');

    this.rpcClient.setTimelineEventHandler(fn);
    return await this.rpcClient.send('startTimeline', {
      appIdKey: this.appIdKey,
      pageIdKey: this.pageIdKey,
      debuggerType: this.debuggerType
    });
  }

  async stopTimeline() {
    _logger.default.debug('Stopping to record the timeline');

    await this.rpcClient.send('stopTimeline', {
      appIdKey: this.appIdKey,
      pageIdKey: this.pageIdKey,
      debuggerType: this.debuggerType
    });
  }

  async startConsole(fn) {
    _logger.default.debug('Starting to listen for JavaScript console');

    this.rpcClient.setConsoleLogEventHandler(fn);
    return await this.rpcClient.send('startConsole', {
      appIdKey: this.appIdKey,
      pageIdKey: this.pageIdKey,
      debuggerType: this.debuggerType
    });
  }

  async stopConsole() {
    _logger.default.debug('Stopping to listen for JavaScript console');

    await this.rpcClient.send('stopConsole', {
      appIdKey: this.appIdKey,
      pageIdKey: this.pageIdKey,
      debuggerType: this.debuggerType
    });
  }

  async startNetwork(fn) {
    _logger.default.debug('Starting to listen for network events');

    this.rpcClient.setNetworkLogEventHandler(fn);
    return await this.rpcClient.send('startNetwork', {
      appIdKey: this.appIdKey,
      pageIdKey: this.pageIdKey,
      debuggerType: this.debuggerType
    });
  }

  async stopNetwork() {
    _logger.default.debug('Stopping to listen for network events');

    await this.rpcClient.send('stopNetwork', {
      appIdKey: this.appIdKey,
      pageIdKey: this.pageIdKey,
      debuggerType: this.debuggerType
    });
  }

  async execute(command, override) {
    if (this.pageLoading && !override) {
      _logger.default.debug('Trying to execute but page is not loaded.');

      await this.waitForDom();
    }

    if (this.debuggerType === DEBUGGER_TYPES.webinspector) {
      let errors = (0, _helpers.checkParams)({
        appIdKey: this.appIdKey,
        pageIdKey: this.pageIdKey
      });
      if (errors) throw new Error(errors);
    }

    if (this.garbageCollectOnExecute) {
      await this.garbageCollect();
    }

    _logger.default.debug(`Sending javascript command ${_lodash.default.truncate(command, {
      length: 50
    })}`);

    let res = await this.rpcClient.send('sendJSCommand', {
      command,
      appIdKey: this.appIdKey,
      pageIdKey: this.pageIdKey,
      debuggerType: this.debuggerType
    });
    return this.convertResult(res);
  }

  async callFunction(objId, fn, args) {
    let errors = (0, _helpers.checkParams)({
      appIdKey: this.appIdKey,
      pageIdKey: this.pageIdKey
    });
    if (errors) throw new Error(errors);

    if (this.garbageCollectOnExecute) {
      await this.garbageCollect();
    }

    _logger.default.debug('Calling javascript function');

    const res = await this.rpcClient.send('callJSFunction', {
      objId,
      fn,
      args,
      appIdKey: this.appIdKey,
      pageIdKey: this.pageIdKey,
      debuggerType: this.debuggerType
    });
    return this.convertResult(res);
  }

  convertResult(res) {
    if (_lodash.default.isUndefined(res)) {
      throw new Error(`Did not get OK result from remote debugger. Result was: ${_lodash.default.truncate((0, _helpers.simpleStringify)(res), {
        length: RESPONSE_LOG_LENGTH
      })}`);
    } else if (_lodash.default.isString(res)) {
      try {
        res = JSON.parse(res);
      } catch (err) {}
    } else if (!_lodash.default.isObject(res)) {
      throw new Error(`Result has unexpected type: (${typeof res}).`);
    }

    if (res.status && res.status !== 0) {
      throw (0, _appiumBaseDriver.errorFromCode)(res.status, res.value.message || res.value);
    }

    return res.hasOwnProperty('value') ? res.value : res;
  }

  allowNavigationWithoutReload(allow = true) {
    if (_lodash.default.isFunction(this.rpcClient.allowNavigationWithoutReload)) {
      this.rpcClient.allowNavigationWithoutReload(allow);
    }
  }

  async getCookies(urls) {
    _logger.default.debug('Getting network cookies');

    return await this.rpcClient.send('getCookies', {
      appIdKey: this.appIdKey,
      pageIdKey: this.pageIdKey,
      debuggerType: this.debuggerType,
      urls
    });
  }

  async deleteCookie(cookieName, url) {
    _logger.default.debug(`Deleting cookie '${cookieName}' on '${url}'`);

    return await this.rpcClient.send('deleteCookie', {
      appIdKey: this.appIdKey,
      pageIdKey: this.pageIdKey,
      debuggerType: this.debuggerType,
      cookieName,
      url
    });
  }

  async garbageCollect(timeoutMs = GARBAGE_COLLECT_TIMEOUT) {
    _logger.default.debug(`Garbage collecting with ${timeoutMs}ms timeout`);

    const errors = (0, _helpers.checkParams)({
      appIdKey: this.appIdKey,
      pageIdKey: this.pageIdKey
    });

    if (errors) {
      _logger.default.debug(`Unable to collect garbage at this time`);

      return;
    }

    await _bluebird.default.resolve(this.rpcClient.send('garbageCollect', {
      appIdKey: this.appIdKey,
      pageIdKey: this.pageIdKey,
      debuggerType: this.debuggerType
    })).timeout(timeoutMs).then(function gcSuccess() {
      _logger.default.debug(`Garbage collection successful`);
    }).catch(function gcError(err) {
      if (err instanceof _bluebird.default.TimeoutError) {
        _logger.default.debug(`Garbage collection timed out after ${timeoutMs}ms`);
      } else {
        _logger.default.debug(`Unable to collect garbage: ${err.message}`);
      }
    });
  }

}

exports.RemoteDebugger = RemoteDebugger;
RemoteDebugger.EVENT_PAGE_CHANGE = 'remote_debugger_page_change';
RemoteDebugger.EVENT_FRAMES_DETACHED = 'remote_debugger_frames_detached';
RemoteDebugger.EVENT_DISCONNECT = 'remote_debugger_disconnect';

for (const [name, handler] of _lodash.default.toPairs(_messageHandlers.default)) {
  RemoteDebugger.prototype[name] = handler;
}require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9yZW1vdGUtZGVidWdnZXIuanMiXSwibmFtZXMiOlsiVkVSU0lPTiIsInJlcXVpcmUiLCJwYXRoIiwicmVzb2x2ZSIsIl9fZGlybmFtZSIsInZlcnNpb24iLCJpZ24iLCJERUJVR0dFUl9UWVBFUyIsIndlYmtpdCIsIndlYmluc3BlY3RvciIsIlNFTEVDVF9BUFBfUkVUUklFUyIsIlJFTU9URV9ERUJVR0dFUl9QT1JUIiwiUlBDX1JFU1BPTlNFX1RJTUVPVVRfTVMiLCJQQUdFX1JFQURZX1RJTUVPVVQiLCJSRVNQT05TRV9MT0dfTEVOR1RIIiwiR0FSQkFHRV9DT0xMRUNUX1RJTUVPVVQiLCJSZW1vdGVEZWJ1Z2dlciIsImV2ZW50cyIsIkV2ZW50RW1pdHRlciIsImNvbnN0cnVjdG9yIiwib3B0cyIsImxvZyIsImluZm8iLCJidW5kbGVJZCIsInBsYXRmb3JtVmVyc2lvbiIsImRlYnVnZ2VyVHlwZSIsImlzU2FmYXJpIiwidXNlTmV3U2FmYXJpIiwicGFnZUxvYWRNcyIsImhvc3QiLCJwb3J0Iiwic29ja2V0UGF0aCIsInBhZ2VSZWFkeVRpbWVvdXQiLCJyZW1vdGVEZWJ1Z1Byb3h5IiwiZ2FyYmFnZUNvbGxlY3RPbkV4ZWN1dGUiLCJsb2dGdWxsUmVzcG9uc2UiLCJkZWJ1ZyIsInNldHVwIiwiYXBwRGljdCIsImFwcElkS2V5IiwicGFnZUlkS2V5IiwicGFnZUxvYWRpbmciLCJfbmF2aWdhdGluZ1RvUGFnZSIsInNwZWNpYWxDYnMiLCJfIiwibm9vcCIsIm9uUGFnZUNoYW5nZSIsImJpbmQiLCJvbkFwcENvbm5lY3QiLCJvbkFwcERpc2Nvbm5lY3QiLCJvbkFwcFVwZGF0ZSIsIm9uUmVwb3J0RHJpdmVyTGlzdCIsInBhZ2VMb2FkIiwiZnJhbWVEZXRhY2hlZCIsInRhcmdldENyZWF0ZWQiLCJvblRhcmdldENyZWF0ZWQiLCJ0YXJnZXREZXN0cm95ZWQiLCJvblRhcmdldERlc3Ryb3llZCIsInJwY0NsaWVudCIsInRlYXJkb3duIiwicmVtb3ZlQWxsTGlzdGVuZXJzIiwiRVZFTlRfUEFHRV9DSEFOR0UiLCJFVkVOVF9ESVNDT05ORUNUIiwiY29ubmVjdCIsIlJlbW90ZURlYnVnZ2VyUnBjQ2xpZW50Iiwic3BlY2lhbE1lc3NhZ2VIYW5kbGVycyIsIm1lc3NhZ2VQcm94eSIsImFwcEluZm8iLCJzZXRDb25uZWN0aW9uS2V5IiwiZXJyIiwiZGlzY29ubmVjdCIsImVtaXQiLCJpc0Nvbm5lY3RlZCIsIkIiLCJyZWplY3QiLCJjb25uZWN0Q2IiLCJhcHBzIiwiaXNVbmRlZmluZWQiLCJrZXlzIiwibGVuZ3RoIiwibmV3RGljdCIsImRpY3QiLCJ2YWx1ZXMiLCJpZCIsImVudHJ5IiwiZGVmYXVsdHMiLCJzZXRTcGVjaWFsTWVzc2FnZUhhbmRsZXIiLCJzaW1OYW1lS2V5Iiwic2ltQnVpbGRLZXkiLCJzaW1QbGF0Zm9ybVZlcnNpb24iLCJzZW5kIiwidXBkYXRlQXBwc1dpdGhEaWN0IiwicGFnZUFycmF5IiwibG9nQXBwbGljYXRpb25EaWN0aW9uYXJ5IiwiZ2V0VmFsdWVTdHJpbmciLCJrZXkiLCJ2YWx1ZSIsImlzRnVuY3Rpb24iLCJpc0FycmF5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFwcCIsInRvUGFpcnMiLCJBcnJheSIsInBhZ2UiLCJwcmVmaXgiLCJrIiwidiIsInZhbHVlU3RyaW5nIiwic2VsZWN0QXBwIiwiY3VycmVudFVybCIsIm1heFRyaWVzIiwiaWdub3JlQWJvdXRCbGFua1VybCIsInBhZ2VEaWN0IiwiYXBwTG9vcCIsImkiLCJwb3NzaWJsZUFwcElkcyIsImpvaW4iLCJhdHRlbXB0ZWRBcHBJZEtleSIsImlzRW1wdHkiLCJmb3VuZCIsImRpY3RMb29wIiwicHJvbWlzZSIsInRpbWVvdXQiLCJUaW1lb3V0RXJyb3IiLCJ1cmwiLCJtZXNzYWdlIiwiZXJyb3JBbmRUaHJvdyIsInBhZ2VQcm9taXNlcyIsIk9iamVjdCIsImZpbHRlciIsIm1hcCIsImFueSIsImRlbGF5IiwiYWxsIiwiZnVsbFBhZ2VBcnJheSIsInJlcGxhY2UiLCJjbG9uZSIsInB1c2giLCJzZWxlY3RQYWdlIiwic2tpcFJlYWR5Q2hlY2siLCJzaG91bGRDaGVja0ZvclRhcmdldCIsInRhcmdldElkIiwiY2hlY2tQYWdlSXNSZWFkeSIsInBhZ2VVbmxvYWQiLCJleGVjdXRlQXRvbSIsImF0b20iLCJhcmdzIiwiZnJhbWVzIiwiY29ubmVjdGVkIiwiRXJyb3IiLCJzY3JpcHQiLCJleGVjdXRlIiwidHJ1bmNhdGUiLCJleGVjdXRlQXRvbUFzeW5jIiwicmVzcG9uc2VVcmwiLCJhc3luY0NhbGxCYWNrIiwiRVZFTlRfRlJBTUVTX0RFVEFDSEVEIiwic3RhcnRQYWdlTG9hZE1zIiwicGFnZUxvYWRWZXJpZnlIb29rIiwidGltZW91dE1zIiwic3RhcnQiLCJEYXRlIiwibm93IiwidmVyaWZ5IiwicGFnZUxvYWREZWxheSIsInV0aWwiLCJjYW5jZWxsYWJsZURlbGF5IiwiQ2FuY2VsbGF0aW9uRXJyb3IiLCJyZWFkeSIsImNhbmNlbFBhZ2VMb2FkIiwiY2FuY2VsIiwid2FpdEZvckRvbSIsImVycm9ycyIsInJlYWR5Q21kIiwicmVhZHlTdGF0ZSIsIm5hdlRvVXJsIiwid2FpdEZvckZyYW1lTmF2aWdhdGVkIiwic3RhcnRNcyIsIm5hdkV2ZW50TGlzdGVuZXIiLCJuYXZpZ2F0aW9uRGVsYXkiLCJzdGFydFRpbWVsaW5lIiwiZm4iLCJzZXRUaW1lbGluZUV2ZW50SGFuZGxlciIsInN0b3BUaW1lbGluZSIsInN0YXJ0Q29uc29sZSIsInNldENvbnNvbGVMb2dFdmVudEhhbmRsZXIiLCJzdG9wQ29uc29sZSIsInN0YXJ0TmV0d29yayIsInNldE5ldHdvcmtMb2dFdmVudEhhbmRsZXIiLCJzdG9wTmV0d29yayIsImNvbW1hbmQiLCJvdmVycmlkZSIsImdhcmJhZ2VDb2xsZWN0IiwicmVzIiwiY29udmVydFJlc3VsdCIsImNhbGxGdW5jdGlvbiIsIm9iaklkIiwiaXNTdHJpbmciLCJwYXJzZSIsImlzT2JqZWN0Iiwic3RhdHVzIiwiaGFzT3duUHJvcGVydHkiLCJhbGxvd05hdmlnYXRpb25XaXRob3V0UmVsb2FkIiwiYWxsb3ciLCJnZXRDb29raWVzIiwidXJscyIsImRlbGV0ZUNvb2tpZSIsImNvb2tpZU5hbWUiLCJ0aGVuIiwiZ2NTdWNjZXNzIiwiY2F0Y2giLCJnY0Vycm9yIiwibmFtZSIsImhhbmRsZXIiLCJtZXNzYWdlSGFuZGxlcnMiLCJwcm90b3R5cGUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBR0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBR0EsSUFBSUEsT0FBSjs7QUFDQSxJQUFJO0FBQ0ZBLEVBQUFBLE9BQU8sR0FBR0MsT0FBTyxDQUFDQyxjQUFLQyxPQUFMLENBQWFDLFNBQWIsRUFBd0IsSUFBeEIsRUFBOEIsSUFBOUIsRUFBb0MsY0FBcEMsQ0FBRCxDQUFQLENBQTZEQyxPQUF2RTtBQUNELENBRkQsQ0FFRSxPQUFPQyxHQUFQLEVBQVksQ0FBRTs7QUFFaEIsTUFBTUMsY0FBYyxHQUFHO0FBQ3JCQyxFQUFBQSxNQUFNLEVBQUUsQ0FEYTtBQUVyQkMsRUFBQUEsWUFBWSxFQUFFO0FBRk8sQ0FBdkI7O0FBSUEsTUFBTUMsa0JBQWtCLEdBQUcsRUFBM0I7QUFDQSxNQUFNQyxvQkFBb0IsR0FBRyxLQUE3Qjs7QUFHQSxNQUFNQyx1QkFBdUIsR0FBRyxJQUFoQzs7QUFFQSxNQUFNQyxrQkFBa0IsR0FBRyxJQUEzQjtBQUVBLE1BQU1DLG1CQUFtQixHQUFHLEdBQTVCO0FBRUEsTUFBTUMsdUJBQXVCLEdBQUcsSUFBaEM7O0FBR0EsTUFBTUMsY0FBTixTQUE2QkMsZ0JBQU9DLFlBQXBDLENBQWlEO0FBVy9DQyxFQUFBQSxXQUFXLENBQUVDLElBQUksR0FBRyxFQUFULEVBQWE7QUFDdEI7O0FBRUEsUUFBSXBCLE9BQUosRUFBYTtBQUNYcUIsc0JBQUlDLElBQUosQ0FBVSwyQkFBMEJ0QixPQUFRLEVBQTVDO0FBQ0Q7O0FBRUQsVUFBTTtBQUNKdUIsTUFBQUEsUUFESTtBQUVKQyxNQUFBQSxlQUZJO0FBR0pDLE1BQUFB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QUFHQSxLQUFLLE1BQU0sQ0FBQ3VKLElBQUQsRUFBT0MsT0FBUCxDQUFYLElBQThCMUssZ0JBQUUwRCxPQUFGLENBQVVpSCx3QkFBVixDQUE5QixFQUEwRDtBQUN4RHZNLEVBQUFBLGNBQWMsQ0FBQ3dNLFNBQWYsQ0FBeUJILElBQXpCLElBQWlDQyxPQUFqQztBQUNEIiwic291cmNlc0NvbnRlbnQiOlsiLy8gdHJhbnNwaWxlOm1haW5cbmltcG9ydCBldmVudHMgZnJvbSAnZXZlbnRzJztcbmltcG9ydCBsb2cgZnJvbSAnLi9sb2dnZXInO1xuaW1wb3J0IHsgZXJyb3JGcm9tQ29kZSB9IGZyb20gJ2FwcGl1bS1iYXNlLWRyaXZlcic7XG5pbXBvcnQgUmVtb3RlRGVidWdnZXJScGNDbGllbnQgZnJvbSAnLi9yZW1vdGUtZGVidWdnZXItcnBjLWNsaWVudCc7XG5pbXBvcnQgbWVzc2FnZUhhbmRsZXJzIGZyb20gJy4vbWVzc2FnZS1oYW5kbGVycyc7XG5pbXBvcnQgeyBhcHBJbmZvRnJvbURpY3QsIHBhZ2VBcnJheUZyb21EaWN0LCBnZXREZWJ1Z2dlckFwcEtleSxcbiAgICAgICAgIGdldFBvc3NpYmxlRGVidWdnZXJBcHBLZXlzLCBjaGVja1BhcmFtcywgZ2V0U2NyaXB0Rm9yQXRvbSxcbiAgICAgICAgIHNpbXBsZVN0cmluZ2lmeSwgZGVmZXJyZWRQcm9taXNlIH0gZnJvbSAnLi9oZWxwZXJzJztcbmltcG9ydCB7IHV0aWwgfSBmcm9tICdhcHBpdW0tc3VwcG9ydCc7XG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IEIgZnJvbSAnYmx1ZWJpcmQnO1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5cblxubGV0IFZFUlNJT047XG50cnkge1xuICBWRVJTSU9OID0gcmVxdWlyZShwYXRoLnJlc29sdmUoX19kaXJuYW1lLCAnLi4nLCAnLi4nLCAncGFja2FnZS5qc29uJykpLnZlcnNpb247XG59IGNhdGNoIChpZ24pIHt9XG5cbmNvbnN0IERFQlVHR0VSX1RZUEVTID0ge1xuICB3ZWJraXQ6IDEsXG4gIHdlYmluc3BlY3RvcjogMlxufTtcbmNvbnN0IFNFTEVDVF9BUFBfUkVUUklFUyA9IDIwO1xuY29uc3QgUkVNT1RFX0RFQlVHR0VSX1BPUlQgPSAyNzc1MztcblxuLyogSG93IG1hbnkgbWlsbGlzZWNvbmRzIHRvIHdhaXQgZm9yIHdlYmtpdCB0byByZXR1cm4gYSByZXNwb25zZSBiZWZvcmUgdGltaW5nIG91dCAqL1xuY29uc3QgUlBDX1JFU1BPTlNFX1RJTUVPVVRfTVMgPSA1MDAwO1xuXG5jb25zdCBQQUdFX1JFQURZX1RJTUVPVVQgPSA1MDAwO1xuXG5jb25zdCBSRVNQT05TRV9MT0dfTEVOR1RIID0gMTAwO1xuXG5jb25zdCBHQVJCQUdFX0NPTExFQ1RfVElNRU9VVCA9IDUwMDA7XG5cblxuY2xhc3MgUmVtb3RlRGVidWdnZXIgZXh0ZW5kcyBldmVudHMuRXZlbnRFbWl0dGVyIHtcbiAgLypcbiAgICogVGhlIGNvbnN0cnVjdG9yIHRha2VzIGFuIG9wdHMgaGFzaCB3aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczpcbiAgICogICAtIGJ1bmRsZUlkIC0gaWQgb2YgdGhlIGFwcCBiZWluZyBjb25uZWN0ZWQgdG9cbiAgICogICAtIHBsYXRmb3JtVmVyc2lvbiAtIHZlcnNpb24gb2YgaU9TXG4gICAqICAgLSBkZWJ1Z2dlclR5cGUgLSBvbmUgb2YgdGhlIERFQlVHR0VSX1RZUEVTXG4gICAqICAgLSB1c2VOZXdTYWZhcmkgLSBmb3Igd2ViIGluc3BlY3Rvciwgd2hldGhlciB0aGlzIGlzIGEgbmV3IFNhZmFyaSBpbnN0YW5jZVxuICAgKiAgIC0gcGFnZUxvYWRNcyAtIHRoZSB0aW1lLCBpbiBtcywgdGhhdCBzaG91bGQgYmUgd2FpdGVkIGZvciBwYWdlIGxvYWRpbmdcbiAgICogICAtIGhvc3QgLSB0aGUgcmVtb3RlIGRlYnVnZ2VyJ3MgaG9zdCBhZGRyZXNzXG4gICAqICAgLSBwb3J0IC0gdGhlIHJlbW90ZSBkZWJ1Z2dlciBwb3J0IHRocm91Z2ggd2hpY2ggdG8gY29tbXVuaWNhdGVcbiAgICovXG4gIGNvbnN0cnVjdG9yIChvcHRzID0ge30pIHtcbiAgICBzdXBlcigpO1xuXG4gICAgaWYgKFZFUlNJT04pIHtcbiAgICAgIGxvZy5pbmZvKGBSZW1vdGUgRGVidWdnZXIgdmVyc2lvbiAke1ZFUlNJT059YCk7XG4gICAgfVxuXG4gICAgY29uc3Qge1xuICAgICAgYnVuZGxlSWQsXG4gICAgICBwbGF0Zm9ybVZlcnNpb24sXG4gICAgICBkZWJ1Z2dlclR5cGUgPSBERUJVR0dFUl9UWVBFUy53ZWJpbnNwZWN0b3IsXG4gICAgICBpc1NhZmFyaSA9IHRydWUsXG4gICAgICB1c2VOZXdTYWZhcmkgPSBmYWxzZSxcbiAgICAgIHBhZ2VMb2FkTXMsXG4gICAgICBob3N0LFxuICAgICAgcG9ydCA9IFJFTU9URV9ERUJVR0dFUl9QT1JULFxuICAgICAgc29ja2V0UGF0aCxcbiAgICAgIHBhZ2VSZWFkeVRpbWVvdXQgPSBQQUdFX1JFQURZX1RJTUVPVVQsXG4gICAgICByZW1vdGVEZWJ1Z1Byb3h5LFxuICAgICAgZ2FyYmFnZUNvbGxlY3RPbkV4ZWN1dGUgPSBmYWxzZSxcbiAgICAgIGxvZ0Z1bGxSZXNwb25zZSA9IGZhbHNlLFxuICAgIH0gPSBvcHRzO1xuXG4gICAgdGhpcy5idW5kbGVJZCA9IGJ1bmRsZUlkO1xuICAgIHRoaXMucGxhdGZvcm1WZXJzaW9uID0gcGxhdGZvcm1WZXJzaW9uO1xuICAgIHRoaXMuaXNTYWZhcmkgPSBpc1NhZmFyaTtcbiAgICB0aGlzLmRlYnVnZ2VyVHlwZSA9IGRlYnVnZ2VyVHlwZTtcbiAgICBpZiAodGhpcy5kZWJ1Z2dlclR5cGUgPT09IERFQlVHR0VSX1RZUEVTLndlYmluc3BlY3Rvcikge1xuICAgICAgdGhpcy51c2VOZXdTYWZhcmkgPSB1c2VOZXdTYWZhcmk7XG4gICAgICB0aGlzLnBhZ2VMb2FkTXMgPSBwYWdlTG9hZE1zO1xuICAgICAgbG9nLmRlYnVnKGB1c2VOZXdTYWZhcmkgLS0+ICR7dGhpcy51c2VOZXdTYWZhcml9YCk7XG4gICAgfVxuICAgIHRoaXMuZ2FyYmFnZUNvbGxlY3RPbkV4ZWN1dGUgPSBnYXJiYWdlQ29sbGVjdE9uRXhlY3V0ZTtcblxuICAgIHRoaXMuaG9zdCA9IGhvc3Q7XG4gICAgdGhpcy5wb3J0ID0gcG9ydDtcbiAgICB0aGlzLnNvY2tldFBhdGggPSBzb2NrZXRQYXRoO1xuICAgIHRoaXMucmVtb3RlRGVidWdQcm94eSA9IHJlbW90ZURlYnVnUHJveHk7XG4gICAgdGhpcy5wYWdlUmVhZHlUaW1lb3V0ID0gcGFnZVJlYWR5VGltZW91dDtcblxuICAgIHRoaXMubG9nRnVsbFJlc3BvbnNlID0gbG9nRnVsbFJlc3BvbnNlO1xuICB9XG5cbiAgc2V0dXAgKCkge1xuICAgIC8vIGFwcCBoYW5kbGluZyBjb25maWd1cmF0aW9uXG4gICAgdGhpcy5hcHBEaWN0ID0ge307XG4gICAgdGhpcy5hcHBJZEtleSA9IG51bGw7XG4gICAgdGhpcy5wYWdlSWRLZXkgPSBudWxsO1xuICAgIHRoaXMucGFnZUxvYWRpbmcgPSBmYWxzZTtcbiAgICB0aGlzLl9uYXZpZ2F0aW5nVG9QYWdlID0gZmFsc2U7XG5cbiAgICAvLyBzZXQgdXAgdGhlIHNwZWNpYWwgY2FsbGJhY2tzIGZvciBoYW5kbGluZyByZCBldmVudHNcbiAgICB0aGlzLnNwZWNpYWxDYnMgPSB7XG4gICAgICAnX3JwY19yZXBvcnRJZGVudGlmaWVyOic6IF8ubm9vcCxcbiAgICAgICdfcnBjX2ZvcndhcmRHZXRMaXN0aW5nOic6IHRoaXMub25QYWdlQ2hhbmdlLmJpbmQodGhpcyksXG4gICAgICAnX3JwY19yZXBvcnRDb25uZWN0ZWRBcHBsaWNhdGlvbkxpc3Q6JzogXy5ub29wLFxuICAgICAgJ19ycGNfYXBwbGljYXRpb25Db25uZWN0ZWQ6JzogdGhpcy5vbkFwcENvbm5lY3QuYmluZCh0aGlzKSxcbiAgICAgICdfcnBjX2FwcGxpY2F0aW9uRGlzY29ubmVjdGVkOic6IHRoaXMub25BcHBEaXNjb25uZWN0LmJpbmQodGhpcyksXG4gICAgICAnX3JwY19hcHBsaWNhdGlvblVwZGF0ZWQ6JzogdGhpcy5vbkFwcFVwZGF0ZS5iaW5kKHRoaXMpLFxuICAgICAgJ19ycGNfcmVwb3J0Q29ubmVjdGVkRHJpdmVyTGlzdDonOiB0aGlzLm9uUmVwb3J0RHJpdmVyTGlzdC5iaW5kKHRoaXMpLFxuICAgICAgcGFnZUxvYWQ6IHRoaXMucGFnZUxvYWQuYmluZCh0aGlzKSxcbiAgICAgIGZyYW1lRGV0YWNoZWQ6IHRoaXMuZnJhbWVEZXRhY2hlZC5iaW5kKHRoaXMpLFxuICAgICAgdGFyZ2V0Q3JlYXRlZDogdGhpcy5vblRhcmdldENyZWF0ZWQuYmluZCh0aGlzKSxcbiAgICAgIHRhcmdldERlc3Ryb3llZDogdGhpcy5vblRhcmdldERlc3Ryb3llZC5iaW5kKHRoaXMpLFxuICAgIH07XG5cbiAgICB0aGlzLnJwY0NsaWVudCA9IG51bGw7XG4gIH1cblxuICB0ZWFyZG93biAoKSB7XG4gICAgbG9nLmRlYnVnKCdDbGVhbmluZyB1cCBsaXN0ZW5lcnMnKTtcblxuICAgIHRoaXMuYXBwRGljdCA9IHt9O1xuICAgIHRoaXMuYXBwSWRLZXkgPSBudWxsO1xuICAgIHRoaXMucGFnZUlkS2V5ID0gbnVsbDtcbiAgICB0aGlzLnBhZ2VMb2FkaW5nID0gZmFsc2U7XG5cbiAgICB0aGlzLnNwZWNpYWxDYnMgPSB7fTtcblxuICAgIHRoaXMucnBjQ2xpZW50ID0gbnVsbDtcblxuICAgIHRoaXMucmVtb3ZlQWxsTGlzdGVuZXJzKFJlbW90ZURlYnVnZ2VyLkVWRU5UX1BBR0VfQ0hBTkdFKTtcbiAgICB0aGlzLnJlbW92ZUFsbExpc3RlbmVycyhSZW1vdGVEZWJ1Z2dlci5FVkVOVF9ESVNDT05ORUNUKTtcbiAgfVxuXG4gIGFzeW5jIGNvbm5lY3QgKCkge1xuICAgIHRoaXMuc2V0dXAoKTtcblxuICAgIC8vIGluaXRpYWxpemUgdGhlIHJwYyBjbGllbnRcbiAgICB0aGlzLnJwY0NsaWVudCA9IG5ldyBSZW1vdGVEZWJ1Z2dlclJwY0NsaWVudCh7XG4gICAgICBwbGF0Zm9ybVZlcnNpb246IHRoaXMucGxhdGZvcm1WZXJzaW9uLFxuICAgICAgaXNTYWZhcmk6IHRoaXMuaXNTYWZhcmksXG4gICAgICBob3N0OiB0aGlzLmhvc3QsXG4gICAgICBwb3J0OiB0aGlzLnBvcnQsXG4gICAgICBzb2NrZXRQYXRoOiB0aGlzLnNvY2tldFBhdGgsXG4gICAgICBzcGVjaWFsTWVzc2FnZUhhbmRsZXJzOiB0aGlzLnNwZWNpYWxDYnMsXG4gICAgICBtZXNzYWdlUHJveHk6IHRoaXMucmVtb3RlRGVidWdQcm94eSxcbiAgICAgIGxvZ0Z1bGxSZXNwb25zZTogdGhpcy5sb2dGdWxsUmVzcG9uc2UsXG4gICAgfSk7XG4gICAgYXdhaXQgdGhpcy5ycGNDbGllbnQuY29ubmVjdCgpO1xuXG4gICAgLy8gZ2V0IHRoZSBjb25uZWN0aW9uIGluZm9ybWF0aW9uIGFib3V0IHRoZSBhcHBcbiAgICB0cnkge1xuICAgICAgY29uc3QgYXBwSW5mbyA9IGF3YWl0IHRoaXMuc2V0Q29ubmVjdGlvbktleSgpO1xuICAgICAgbG9nLmRlYnVnKCdDb25uZWN0ZWQgdG8gYXBwbGljYXRpb24nKTtcbiAgICAgIHJldHVybiBhcHBJbmZvO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgYXdhaXQgdGhpcy5kaXNjb25uZWN0KCk7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gIH1cblxuICBhc3luYyBkaXNjb25uZWN0ICgpIHtcbiAgICBhd2FpdCB0aGlzLnJwY0NsaWVudC5kaXNjb25uZWN0KCk7XG4gICAgdGhpcy5lbWl0KFJlbW90ZURlYnVnZ2VyLkVWRU5UX0RJU0NPTk5FQ1QsIHRydWUpO1xuICAgIHRoaXMudGVhcmRvd24oKTtcbiAgfVxuXG4gIGlzQ29ubmVjdGVkICgpIHtcbiAgICByZXR1cm4gISEodGhpcy5ycGNDbGllbnQgJiYgdGhpcy5ycGNDbGllbnQuaXNDb25uZWN0ZWQoKSk7XG4gIH1cblxuICBhc3luYyBzZXRDb25uZWN0aW9uS2V5ICgpIHtcbiAgICAvLyBvbmx5IHJlc29sdmUgd2hlbiB0aGUgY29ubmVjdGlvbiByZXNwb25zZSBpcyByZWNlaXZlZFxuICAgIHJldHVybiBhd2FpdCBuZXcgQigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAvLyBsb2NhbCBjYWxsYmFjaywgY2FsbGVkIHdoZW4gdGhlIHJlbW90ZSBkZWJ1Z2dlciBoYXMgZXN0YWJsaXNoZWRcbiAgICAgIC8vIGEgY29ubmVjdGlvbiB0byB0aGUgYXBwIHVuZGVyIHRlc3RcbiAgICAgIC8vIGBhcHBgIHdpbGwgYmUgYW4gYXJyYXkgb2YgZGljdGlvbmFyaWVzIG9mIGFwcCBpbmZvcm1hdGlvblxuICAgICAgbGV0IGNvbm5lY3RDYiA9IChhcHBzKSA9PiB7XG4gICAgICAgIGlmIChfLmlzVW5kZWZpbmVkKGFwcHMpIHx8IF8ua2V5cyhhcHBzKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICBsb2cuZGVidWcoJ1JlY2VpdmVkIG5vIGFwcHMgZnJvbSByZW1vdGUgZGVidWdnZXIuIFVuYWJsZSB0byBjb25uZWN0LicpO1xuICAgICAgICAgIHJldHVybiByZXNvbHZlKHRoaXMuYXBwRGljdCk7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IG5ld0RpY3QgPSB7fTtcblxuICAgICAgICAvLyB0cmFuc2xhdGUgdGhlIHJlY2VpdmVkIGluZm9ybWF0aW9uIGludG8gYW4gZWFzaWVyLXRvLW1hbmFnZVxuICAgICAgICAvLyBoYXNoIHdpdGggYXBwIGlkIGFzIGtleSwgYW5kIGFwcCBpbmZvIGFzIHZhbHVlXG4gICAgICAgIGZvciAoY29uc3QgZGljdCBvZiBfLnZhbHVlcyhhcHBzKSkge1xuICAgICAgICAgIGxldCBbaWQsIGVudHJ5XSA9IGFwcEluZm9Gcm9tRGljdChkaWN0KTtcbiAgICAgICAgICBuZXdEaWN0W2lkXSA9IGVudHJ5O1xuICAgICAgICB9XG4gICAgICAgIC8vIHVwZGF0ZSB0aGUgb2JqZWN0J3MgbGlzdCBvZiBhcHBzLCBhbmQgcmV0dXJuIGl0IHRocm91Z2ggdGhlIHByb21pc2VcbiAgICAgICAgXy5kZWZhdWx0cyh0aGlzLmFwcERpY3QsIG5ld0RpY3QpO1xuICAgICAgICByZXNvbHZlKG5ld0RpY3QpO1xuICAgICAgfTtcbiAgICAgIHRoaXMucnBjQ2xpZW50LnNldFNwZWNpYWxNZXNzYWdlSGFuZGxlcignX3JwY19yZXBvcnRDb25uZWN0ZWRBcHBsaWNhdGlvbkxpc3Q6JywgcmVqZWN0LCBjb25uZWN0Q2IpO1xuXG4gICAgICBsb2cuZGVidWcoJ1NlbmRpbmcgY29ubmVjdGlvbiBrZXkgcmVxdWVzdCcpO1xuICAgICAgcmV0dXJuIChhc3luYyAoKSA9PiB7XG4gICAgICAgIGxldCBbc2ltTmFtZUtleSwgc2ltQnVpbGRLZXksIHNpbVBsYXRmb3JtVmVyc2lvbl0gPSBhd2FpdCB0aGlzLnJwY0NsaWVudC5zZW5kKCdzZXRDb25uZWN0aW9uS2V5Jyk7XG4gICAgICAgIGxvZy5kZWJ1ZyhgU2ltIG5hbWU6ICR7c2ltTmFtZUtleX1gKTtcbiAgICAgICAgbG9nLmRlYnVnKGBTaW0gYnVpbGQ6ICR7c2ltQnVpbGRLZXl9YCk7XG4gICAgICAgIGxvZy5kZWJ1ZyhgU2ltIHBsYXRmb3JtIHZlcnNpb246ICR7c2ltUGxhdGZvcm1WZXJzaW9ufWApO1xuICAgICAgfSkoKTtcbiAgICB9KTtcbiAgfVxuXG4gIHVwZGF0ZUFwcHNXaXRoRGljdCAoZGljdCkge1xuICAgIC8vIGdldCB0aGUgZGljdGlvbmFyeSBlbnRyeSBpbnRvIGEgbmljZSBmb3JtLCBhbmQgYWRkIGl0IHRvIHRoZVxuICAgIC8vIGFwcGxpY2F0aW9uIGRpY3Rpb25hcnlcbiAgICB0aGlzLmFwcERpY3QgPSB0aGlzLmFwcERpY3QgfHwge307XG4gICAgbGV0IFtpZCwgZW50cnldID0gYXBwSW5mb0Zyb21EaWN0KGRpY3QpO1xuICAgIGlmICh0aGlzLmFwcERpY3RbaWRdKSB7XG4gICAgICAvLyBwcmVzZXJ2ZSB0aGUgcGFnZSBkaWN0aW9uYXJ5IGZvciB0aGlzIGVudHJ5XG4gICAgICBlbnRyeS5wYWdlQXJyYXkgPSB0aGlzLmFwcERpY3RbaWRdLnBhZ2VBcnJheTtcbiAgICB9XG4gICAgdGhpcy5hcHBEaWN0W2lkXSA9IGVudHJ5O1xuXG4gICAgLy8gYWRkIGEgcHJvbWlzZSB0byBnZXQgdGhlIHBhZ2UgZGljdGlvbmFyeVxuICAgIGlmIChfLmlzVW5kZWZpbmVkKGVudHJ5LnBhZ2VBcnJheSkpIHtcbiAgICAgIGVudHJ5LnBhZ2VBcnJheSA9IGRlZmVycmVkUHJvbWlzZSgpO1xuICAgIH1cblxuICAgIC8vIHRyeSB0byBnZXQgdGhlIGFwcCBpZCBmcm9tIG91ciBjb25uZWN0ZWQgYXBwc1xuICAgIGlmICghdGhpcy5hcHBJZEtleSkge1xuICAgICAgdGhpcy5hcHBJZEtleSA9IGdldERlYnVnZ2VyQXBwS2V5KHRoaXMuYnVuZGxlSWQsIHRoaXMucGxhdGZvcm1WZXJzaW9uLCB0aGlzLmFwcERpY3QpO1xuICAgIH1cbiAgfVxuXG4gIGxvZ0FwcGxpY2F0aW9uRGljdGlvbmFyeSAoYXBwcykge1xuICAgIGZ1bmN0aW9uIGdldFZhbHVlU3RyaW5nIChrZXksIHZhbHVlKSB7XG4gICAgICBpZiAoXy5pc0Z1bmN0aW9uKHZhbHVlKSkge1xuICAgICAgICByZXR1cm4gJ1tGdW5jdGlvbl0nO1xuICAgICAgfVxuICAgICAgaWYgKGtleSA9PT0gJ3BhZ2VBcnJheScgJiYgIV8uaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgICAgcmV0dXJuIGAnV2FpdGluZyBmb3IgZGF0YSdgO1xuICAgICAgfVxuICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KHZhbHVlKTtcbiAgICB9XG4gICAgbG9nLmRlYnVnKCdDdXJyZW50IGFwcGxpY2F0aW9ucyBhdmFpbGFibGU6Jyk7XG4gICAgZm9yIChjb25zdCBbYXBwLCBpbmZvXSBvZiBfLnRvUGFpcnMoYXBwcykpIHtcbiAgICAgIGxvZy5kZWJ1ZyhgICAgIEFwcGxpY2F0aW9uOiAnJHthcHB9J2ApO1xuICAgICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgXy50b1BhaXJzKGluZm8pKSB7XG4gICAgICAgIGlmIChrZXkgPT09ICdwYWdlQXJyYXknICYmIEFycmF5LmlzQXJyYXkodmFsdWUpICYmIHZhbHVlLmxlbmd0aCkge1xuICAgICAgICAgIGxvZy5kZWJ1ZyhgICAgICAgICAke2tleX06YCk7XG4gICAgICAgICAgZm9yIChjb25zdCBwYWdlIG9mIHZhbHVlKSB7XG4gICAgICAgICAgICBsZXQgcHJlZml4ID0gJy0gJztcbiAgICAgICAgICAgIGZvciAoY29uc3QgW2ssIHZdIG9mIF8udG9QYWlycyhwYWdlKSkge1xuICAgICAgICAgICAgICBsb2cuZGVidWcoYCAgICAgICAgICAke3ByZWZpeH0ke2t9OiAke0pTT04uc3RyaW5naWZ5KHYpfWApO1xuICAgICAgICAgICAgICBwcmVmaXggPSAnICAnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25zdCB2YWx1ZVN0cmluZyA9IGdldFZhbHVlU3RyaW5nKGtleSwgdmFsdWUpO1xuICAgICAgICAgIGxvZy5kZWJ1ZyhgICAgICAgICAke2tleX06ICR7dmFsdWVTdHJpbmd9YCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBhc3luYyBzZWxlY3RBcHAgKGN1cnJlbnRVcmwgPSBudWxsLCBtYXhUcmllcyA9IFNFTEVDVF9BUFBfUkVUUklFUywgaWdub3JlQWJvdXRCbGFua1VybCA9IGZhbHNlKSB7XG4gICAgbG9nLmRlYnVnKCdTZWxlY3RpbmcgYXBwbGljYXRpb24nKTtcbiAgICBpZiAoIXRoaXMuYXBwRGljdCB8fCBfLmtleXModGhpcy5hcHBEaWN0KS5sZW5ndGggPT09IDApIHtcbiAgICAgIGxvZy5kZWJ1ZygnTm8gYXBwbGljYXRpb25zIGN1cnJlbnRseSBjb25uZWN0ZWQuJyk7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuXG4gICAgLy8gaXRlcmF0aXZlIHNvbHV0aW9uLCBhcyByZWN1cnNpb24gd2FzIHN3YWxsb3dpbmcgdGhlIHByb21pc2UgYXQgc29tZSBwb2ludFxuICAgIGxldCBwYWdlRGljdCwgYXBwSWRLZXk7XG4gICAgYXBwTG9vcDogZm9yIChsZXQgaSA9IDA7IGkgPCBtYXhUcmllczsgaSsrKSB7XG4gICAgICB0aGlzLmxvZ0FwcGxpY2F0aW9uRGljdGlvbmFyeSh0aGlzLmFwcERpY3QpO1xuICAgICAgbGV0IHBvc3NpYmxlQXBwSWRzID0gZ2V0UG9zc2libGVEZWJ1Z2dlckFwcEtleXModGhpcy5idW5kbGVJZCwgdGhpcy5wbGF0Zm9ybVZlcnNpb24sIHRoaXMuYXBwRGljdCk7XG4gICAgICBsb2cuZGVidWcoYFRyeWluZyBvdXQgdGhlIHBvc3NpYmxlIGFwcCBpZHM6ICR7cG9zc2libGVBcHBJZHMuam9pbignLCAnKX1gKTtcbiAgICAgIGZvciAoY29uc3QgYXR0ZW1wdGVkQXBwSWRLZXkgb2YgcG9zc2libGVBcHBJZHMpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBsb2cuZGVidWcoYFNlbGVjdGluZyBhcHAgJHthdHRlbXB0ZWRBcHBJZEtleX0gKHRyeSAjJHtpICsgMX0gb2YgJHttYXhUcmllc30pYCk7XG4gICAgICAgICAgW2FwcElkS2V5LCBwYWdlRGljdF0gPSBhd2FpdCB0aGlzLnJwY0NsaWVudC5zZWxlY3RBcHAoYXR0ZW1wdGVkQXBwSWRLZXksIHRoaXMub25BcHBDb25uZWN0LmJpbmQodGhpcykpO1xuICAgICAgICAgIC8vIGluIGlPUyA4LjIgdGhlIGNvbm5lY3QgbG9naWMgaGFwcGVucywgYnV0IHdpdGggYW4gZW1wdHkgZGljdGlvbmFyeVxuICAgICAgICAgIC8vIHdoaWNoIGxlYWRzIHRvIHRoZSByZW1vdGUgZGVidWdnZXIgZ2V0dGluZyBkaXNjb25uZWN0ZWQsIGFuZCBpbnRvIGEgbG9vcFxuICAgICAgICAgIGlmIChfLmlzRW1wdHkocGFnZURpY3QpKSB7XG4gICAgICAgICAgICBsb2cuZGVidWcoJ0VtcHR5IHBhZ2UgZGljdGlvbmFyeSByZWNlaXZlZC4gVHJ5aW5nIGFnYWluLicpO1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gc2F2ZSB0aGUgcGFnZSBhcnJheSBmb3IgdGhpcyBhcHBcbiAgICAgICAgICB0aGlzLmFwcERpY3RbYXBwSWRLZXldLnBhZ2VBcnJheSA9IHBhZ2VBcnJheUZyb21EaWN0KHBhZ2VEaWN0KTtcblxuICAgICAgICAgIC8vIGlmIHdlIGFyZSBsb29raW5nIGZvciBhIHBhcnRpY3VsYXIgdXJsLCBtYWtlIHN1cmUgd2UgaGF2ZSB0aGUgcmlnaHQgcGFnZS4gSWdub3JlIGVtcHR5IG9yIHVuZGVmaW5lZCB1cmxzLiBJZ25vcmUgYWJvdXQ6YmxhbmsgaWYgcmVxdWVzdGVkLlxuICAgICAgICAgIGxldCBmb3VuZCA9IGZhbHNlO1xuICAgICAgICAgIGRpY3RMb29wOiBmb3IgKGNvbnN0IGFwcERpY3Qgb2YgXy52YWx1ZXModGhpcy5hcHBEaWN0KSkge1xuICAgICAgICAgICAgaWYgKGZvdW5kKSBicmVhazsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBjdXJseVxuXG4gICAgICAgICAgICBpZiAoIWFwcERpY3QgfHwgIWFwcERpY3QucGFnZUFycmF5KSB7XG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBpZiB0aGUgcGFnZSBkaWN0aW9uYXJ5IGhhcyBub3QgYmVlbiBsb2FkZWQgeWV0IGZyb20gdGhlIHdlYlxuICAgICAgICAgICAgLy8gaW5zcGVjdG9yLCB3YWl0IGZvciBpdCBvciB0aW1lIG91dCBhZnRlciAxMHNcbiAgICAgICAgICAgIGlmIChhcHBEaWN0LnBhZ2VBcnJheS5wcm9taXNlKSB7XG4gICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgQi5yZXNvbHZlKGFwcERpY3QucGFnZUFycmF5LnByb21pc2UpLnRpbWVvdXQoMTAwMDApO1xuICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICBpZiAoIShlcnIgaW5zdGFuY2VvZiBCLlRpbWVvdXRFcnJvcikpIHtcbiAgICAgICAgICAgICAgICAgIHRocm93IGVycjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gb24gdGltZW91dCwganVzdCBnbyBvblxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZvciAoY29uc3QgZGljdCBvZiAoYXBwRGljdC5wYWdlQXJyYXkgfHwgW10pKSB7XG4gICAgICAgICAgICAgIGlmICgoIWlnbm9yZUFib3V0QmxhbmtVcmwgfHwgZGljdC51cmwgIT09ICdhYm91dDpibGFuaycpICYmXG4gICAgICAgICAgICAgICAgICAoIWN1cnJlbnRVcmwgfHwgZGljdC51cmwgPT09IGN1cnJlbnRVcmwgfHwgZGljdC51cmwgPT09IGAke2N1cnJlbnRVcmx9L2ApKSB7XG4gICAgICAgICAgICAgICAgLy8gc2F2ZSB3aGVyZSB3ZSBmb3VuZCB0aGUgcmlnaHQgcGFnZVxuICAgICAgICAgICAgICAgIGFwcElkS2V5ID0gYXBwRGljdC5pZDtcbiAgICAgICAgICAgICAgICBwYWdlRGljdCA9IGRpY3Q7XG4gICAgICAgICAgICAgICAgZm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGJyZWFrIGRpY3RMb29wO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICghZm91bmQpIHtcbiAgICAgICAgICAgIGlmIChjdXJyZW50VXJsKSB7XG4gICAgICAgICAgICAgIGxvZy5kZWJ1ZyhgUmVjZWl2ZWQgYXBwLCBidXQgZXhwZWN0ZWQgdXJsICgnJHtjdXJyZW50VXJsfScpIHdhcyBub3QgZm91bmQuIFRyeWluZyBhZ2Fpbi5gKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGxvZy5kZWJ1ZygnUmVjZWl2ZWQgYXBwLCBidXQgbm8gbWF0Y2ggd2FzIGZvdW5kLiBUcnlpbmcgYWdhaW4uJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwYWdlRGljdCA9IG51bGw7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyB3ZSBoYXZlIGdvdHRlbiB0aGUgY29ycmVjdCBhcHBsaWNhdGlvbiBieSB0aGlzIHBvaW50LCBzbyBzaG9ydCBjaXJjdWl0IGV2ZXJ5dGhpbmdcbiAgICAgICAgICBicmVhayBhcHBMb29wO1xuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICBsb2cuZGVidWcoYEVycm9yIGNoZWNraW5nIGFwcGxpY2F0aW9uOiAnJHtlcnIubWVzc2FnZX0nLiBSZXRyeWluZyBjb25uZWN0aW9uYCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBpZiwgYWZ0ZXIgYWxsIHRoaXMsIHdlIGhhdmUgbm8gZGljdGlvbmFyeSwgd2UgaGF2ZSBmYWlsZWRcbiAgICBpZiAoIXBhZ2VEaWN0KSB7XG4gICAgICBsb2cuZXJyb3JBbmRUaHJvdyhgQ291bGQgbm90IGNvbm5lY3QgdG8gYSB2YWxpZCBhcHAgYWZ0ZXIgJHttYXhUcmllc30gdHJpZXMuYCk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuYXBwSWRLZXkgIT09IGFwcElkS2V5KSB7XG4gICAgICBsb2cuZGVidWcoYFJlY2VpdmVkIGFsdGVyZWQgYXBwIGlkLCB1cGRhdGluZyBmcm9tICcke3RoaXMuYXBwSWRLZXl9JyB0byAnJHthcHBJZEtleX0nYCk7XG4gICAgICB0aGlzLmFwcElkS2V5ID0gYXBwSWRLZXk7XG4gICAgfVxuXG4gICAgLy8gd2FpdCBmb3IgYWxsIHRoZSBwcm9taXNlcyBhcmUgYmFjaywgb3IgMzBzIHBhc3Nlc1xuICAgIGNvbnN0IHBhZ2VQcm9taXNlcyA9IE9iamVjdC52YWx1ZXModGhpcy5hcHBEaWN0KVxuICAgICAgLmZpbHRlcigoYXBwKSA9PiAhIWFwcC5wYWdlQXJyYXkgJiYgISFhcHAucGFnZUFycmF5LnByb21pc2UpXG4gICAgICAubWFwKChhcHApID0+IGFwcC5wYWdlQXJyYXkucHJvbWlzZSk7XG4gICAgaWYgKHBhZ2VQcm9taXNlcy5sZW5ndGgpIHtcbiAgICAgIGxvZy5kZWJ1ZyhgV2FpdGluZyBmb3IgJHtwYWdlUHJvbWlzZXMubGVuZ3RofSBwYWdlcyB0byBiZSBmdWxmaWxsZWRgKTtcbiAgICAgIGF3YWl0IEIuYW55KFtCLmRlbGF5KDMwMDAwKSwgQi5hbGwocGFnZVByb21pc2VzKV0pO1xuICAgIH1cblxuICAgIHRoaXMubG9nQXBwbGljYXRpb25EaWN0aW9uYXJ5KHRoaXMuYXBwRGljdCk7XG5cbiAgICAvLyB0cmFuc2xhdGUgdGhlIGRpY3Rpb25hcnkgaW50byBhIHVzZWZ1bCBmb3JtLCBhbmQgcmV0dXJuIHRvIHNlbmRlclxuICAgIGNvbnN0IHBhZ2VBcnJheSA9IF8uaXNFbXB0eSh0aGlzLmFwcERpY3RbYXBwSWRLZXldLnBhZ2VBcnJheSlcbiAgICAgID8gcGFnZUFycmF5RnJvbURpY3QocGFnZURpY3QpXG4gICAgICA6IHRoaXMuYXBwRGljdFthcHBJZEtleV0ucGFnZUFycmF5O1xuICAgIGxvZy5kZWJ1ZyhgRmluYWxseSBzZWxlY3RpbmcgYXBwICR7dGhpcy5hcHBJZEtleX06ICR7c2ltcGxlU3RyaW5naWZ5KHBhZ2VBcnJheSl9YCk7XG5cbiAgICBsZXQgZnVsbFBhZ2VBcnJheSA9IFtdO1xuICAgIGZvciAoY29uc3QgW2FwcCwgaW5mb10gb2YgXy50b1BhaXJzKHRoaXMuYXBwRGljdCkpIHtcbiAgICAgIGlmICghXy5pc0FycmF5KGluZm8ucGFnZUFycmF5KSkgY29udGludWU7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgY3VybHlcbiAgICAgIGxldCBpZCA9IGFwcC5yZXBsYWNlKCdQSUQ6JywgJycpO1xuICAgICAgZm9yIChjb25zdCBwYWdlIG9mIGluZm8ucGFnZUFycmF5KSB7XG4gICAgICAgIGlmIChwYWdlLnVybCAmJiAoIWlnbm9yZUFib3V0QmxhbmtVcmwgfHwgcGFnZS51cmwgIT09ICdhYm91dDpibGFuaycpICYmICghY3VycmVudFVybCB8fCBwYWdlLnVybCA9PT0gY3VycmVudFVybCB8fCBwYWdlLnVybCA9PT0gYCR7Y3VycmVudFVybH0vYCkpIHtcbiAgICAgICAgICBsZXQgcGFnZURpY3QgPSBfLmNsb25lKHBhZ2UpO1xuICAgICAgICAgIHBhZ2VEaWN0LmlkID0gYCR7aWR9LiR7cGFnZURpY3QuaWR9YDtcbiAgICAgICAgICBmdWxsUGFnZUFycmF5LnB1c2gocGFnZURpY3QpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGZ1bGxQYWdlQXJyYXk7XG4gIH1cblxuICBhc3luYyBzZWxlY3RQYWdlIChhcHBJZEtleSwgcGFnZUlkS2V5LCBza2lwUmVhZHlDaGVjayA9IGZhbHNlKSB7XG4gICAgdGhpcy5hcHBJZEtleSA9IGBQSUQ6JHthcHBJZEtleX1gO1xuICAgIHRoaXMucGFnZUlkS2V5ID0gcGFnZUlkS2V5O1xuXG4gICAgbG9nLmRlYnVnKGBTZWxlY3RpbmcgcGFnZSAnJHtwYWdlSWRLZXl9JyBvbiBhcHAgJyR7dGhpcy5hcHBJZEtleX0nIGFuZCBmb3J3YXJkaW5nIHNvY2tldCBzZXR1cGApO1xuXG4gICAgYXdhaXQgdGhpcy5ycGNDbGllbnQuc2VuZCgnc2V0U2VuZGVyS2V5Jywge1xuICAgICAgYXBwSWRLZXk6IHRoaXMuYXBwSWRLZXksXG4gICAgICBwYWdlSWRLZXk6IHRoaXMucGFnZUlkS2V5XG4gICAgfSk7XG4gICAgbG9nLmRlYnVnKCdTZW5kZXIga2V5IHNldCcpO1xuXG4gICAgdGhpcy5ycGNDbGllbnQuc2hvdWxkQ2hlY2tGb3JUYXJnZXQgPSB0cnVlO1xuICAgIGF3YWl0IHRoaXMucnBjQ2xpZW50LnNlbmQoJ2VuYWJsZVBhZ2UnLCB7XG4gICAgICBhcHBJZEtleTogdGhpcy5hcHBJZEtleSxcbiAgICAgIHBhZ2VJZEtleTogdGhpcy5wYWdlSWRLZXksXG4gICAgICBkZWJ1Z2dlclR5cGU6IHRoaXMuZGVidWdnZXJUeXBlLFxuICAgICAgdGFyZ2V0SWQ6ICdwYWdlLTEnLFxuICAgIH0pO1xuICAgIGxvZy5kZWJ1ZygnRW5hYmxlZCBhY3Rpdml0eSBvbiBwYWdlJyk7XG5cbiAgICAvLyBtYWtlIHN1cmUgZXZlcnl0aGluZyBpcyByZWFkeSB0byBnb1xuICAgIGlmICghc2tpcFJlYWR5Q2hlY2sgJiYgIWF3YWl0IHRoaXMuY2hlY2tQYWdlSXNSZWFkeSgpKSB7XG4gICAgICBhd2FpdCB0aGlzLnBhZ2VVbmxvYWQoKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBleGVjdXRlQXRvbSAoYXRvbSwgYXJncywgZnJhbWVzKSB7XG4gICAgaWYgKCF0aGlzLnJwY0NsaWVudC5jb25uZWN0ZWQpIHRocm93IG5ldyBFcnJvcignUmVtb3RlIGRlYnVnZ2VyIGlzIG5vdCBjb25uZWN0ZWQnKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBjdXJseVxuXG4gICAgbG9nLmRlYnVnKGBFeGVjdXRpbmcgYXRvbSAnJHthdG9tfSdgKTtcbiAgICBjb25zdCBzY3JpcHQgPSBhd2FpdCBnZXRTY3JpcHRGb3JBdG9tKGF0b20sIGFyZ3MsIGZyYW1lcyk7XG4gICAgY29uc3QgdmFsdWUgPSBhd2FpdCB0aGlzLmV4ZWN1dGUoc2NyaXB0LCB0cnVlKTtcbiAgICBsb2cuZGVidWcoYFJlY2VpdmVkIHJlc3VsdCBmb3IgYXRvbSAnJHthdG9tfScgZXhlY3V0aW9uOiAke18udHJ1bmNhdGUoc2ltcGxlU3RyaW5naWZ5KHZhbHVlKSwge2xlbmd0aDogUkVTUE9OU0VfTE9HX0xFTkdUSH0pfWApO1xuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxuXG4gIGFzeW5jIGV4ZWN1dGVBdG9tQXN5bmMgKGF0b20sIGFyZ3MsIGZyYW1lcywgcmVzcG9uc2VVcmwpIHtcbiAgICBsZXQgYXN5bmNDYWxsQmFjayA9IGBmdW5jdGlvbiAocmVzKSB7IHhtbEh0dHAgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTsgYCArXG4gICAgICAgICAgICAgICAgICAgICAgICBgeG1sSHR0cC5vcGVuKCdQT1NUJywgJyR7cmVzcG9uc2VVcmx9JywgdHJ1ZSk7YCArXG4gICAgICAgICAgICAgICAgICAgICAgICBgeG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKCdDb250ZW50LXR5cGUnLCdhcHBsaWNhdGlvbi9qc29uJyk7IGAgK1xuICAgICAgICAgICAgICAgICAgICAgICAgYHhtbEh0dHAuc2VuZChyZXMpOyB9YDtcbiAgICBsZXQgc2NyaXB0ID0gYXdhaXQgZ2V0U2NyaXB0Rm9yQXRvbShhdG9tLCBhcmdzLCBmcmFtZXMsIGFzeW5jQ2FsbEJhY2spO1xuICAgIGF3YWl0IHRoaXMuZXhlY3V0ZShzY3JpcHQpO1xuICB9XG5cbiAgZnJhbWVEZXRhY2hlZCAoKSB7XG4gICAgdGhpcy5lbWl0KFJlbW90ZURlYnVnZ2VyLkVWRU5UX0ZSQU1FU19ERVRBQ0hFRCk7XG4gIH1cblxuICBhc3luYyBwYWdlTG9hZCAoc3RhcnRQYWdlTG9hZE1zLCBwYWdlTG9hZFZlcmlmeUhvb2spIHtcbiAgICBsZXQgdGltZW91dE1zID0gNTAwO1xuICAgIGxldCBzdGFydCA9IHN0YXJ0UGFnZUxvYWRNcyB8fCBEYXRlLm5vdygpO1xuICAgIGxvZy5kZWJ1ZygnUGFnZSBsb2FkZWQsIHZlcmlmeWluZyB3aGV0aGVyIHJlYWR5Jyk7XG5cbiAgICBjb25zdCB2ZXJpZnkgPSBhc3luYyAoKSA9PiB7XG4gICAgICB0aGlzLnBhZ2VMb2FkRGVsYXkgPSB1dGlsLmNhbmNlbGxhYmxlRGVsYXkodGltZW91dE1zKTtcbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IHRoaXMucGFnZUxvYWREZWxheTtcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBpZiAoZXJyIGluc3RhbmNlb2YgQi5DYW5jZWxsYXRpb25FcnJvcikge1xuICAgICAgICAgIC8vIGlmIHRoZSBwcm9taXNlIGhhcyBiZWVuIGNhbmNlbGxlZFxuICAgICAgICAgIC8vIHdlIHdhbnQgdG8gc2tpcCBjaGVja2luZyB0aGUgcmVhZGluZXNzXG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIHdlIGNhbiBnZXQgdGhpcyBjYWxsZWQgaW4gdGhlIG1pZGRsZSBvZiB0cnlpbmcgdG8gZmluZCBhIG5ldyBhcHBcbiAgICAgIGlmICghdGhpcy5hcHBJZEtleSkge1xuICAgICAgICBsb2cuZGVidWcoJ05vdCBjb25uZWN0ZWQgdG8gYW4gYXBwbGljYXRpb24uIElnbm9yaW5nIHBhZ2UgbG9hZCcpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmIChfLmlzRnVuY3Rpb24ocGFnZUxvYWRWZXJpZnlIb29rKSkge1xuICAgICAgICBhd2FpdCBwYWdlTG9hZFZlcmlmeUhvb2soKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcmVhZHkgPSBhd2FpdCB0aGlzLmNoZWNrUGFnZUlzUmVhZHkoKTtcblxuICAgICAgLy8gaWYgd2UgYXJlIHJlYWR5LCBvciB3ZSd2ZSBzcGVuZCB0b28gbXVjaCB0aW1lIG9uIHRoaXNcbiAgICAgIGlmIChyZWFkeSB8fCAodGhpcy5wYWdlTG9hZE1zID4gMCAmJiAoc3RhcnQgKyB0aGlzLnBhZ2VMb2FkTXMpIDwgRGF0ZS5ub3coKSkpIHtcbiAgICAgICAgbG9nLmRlYnVnKCdQYWdlIGlzIHJlYWR5Jyk7XG4gICAgICAgIHRoaXMucGFnZUxvYWRpbmcgPSBmYWxzZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxvZy5kZWJ1ZygnUGFnZSB3YXMgbm90IHJlYWR5LCByZXRyeWluZycpO1xuICAgICAgICBhd2FpdCB2ZXJpZnkoKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIGF3YWl0IHZlcmlmeSgpO1xuICB9XG5cbiAgY2FuY2VsUGFnZUxvYWQgKCkge1xuICAgIGxvZy5kZWJ1ZygnVW5yZWdpc3RlcmluZyBmcm9tIHBhZ2UgcmVhZGluZXNzIG5vdGlmaWNhdGlvbnMnKTtcbiAgICB0aGlzLnBhZ2VMb2FkaW5nID0gZmFsc2U7XG4gICAgaWYgKHRoaXMucGFnZUxvYWREZWxheSkge1xuICAgICAgdGhpcy5wYWdlTG9hZERlbGF5LmNhbmNlbCgpO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHBhZ2VVbmxvYWQgKCkge1xuICAgIGxvZy5kZWJ1ZygnUGFnZSB1bmxvYWRpbmcnKTtcbiAgICB0aGlzLnBhZ2VMb2FkaW5nID0gdHJ1ZTtcbiAgICBhd2FpdCB0aGlzLndhaXRGb3JEb20oKTtcbiAgfVxuXG4gIGFzeW5jIHdhaXRGb3JEb20gKHN0YXJ0UGFnZUxvYWRNcywgcGFnZUxvYWRWZXJpZnlIb29rKSB7XG4gICAgbG9nLmRlYnVnKCdXYWl0aW5nIGZvciBkb20uLi4nKTtcbiAgICBhd2FpdCB0aGlzLnBhZ2VMb2FkKHN0YXJ0UGFnZUxvYWRNcywgcGFnZUxvYWRWZXJpZnlIb29rKTtcbiAgfVxuXG4gIGFzeW5jIGNoZWNrUGFnZUlzUmVhZHkgKCkge1xuICAgIGNvbnN0IGVycm9ycyA9IGNoZWNrUGFyYW1zKHthcHBJZEtleTogdGhpcy5hcHBJZEtleX0pO1xuICAgIGlmIChlcnJvcnMpIHRocm93IG5ldyBFcnJvcihlcnJvcnMpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIGN1cmx5XG5cbiAgICBsb2cuZGVidWcoJ0NoZWNraW5nIGRvY3VtZW50IHJlYWR5U3RhdGUnKTtcbiAgICBjb25zdCByZWFkeUNtZCA9ICcoZnVuY3Rpb24gKCl7IHJldHVybiBkb2N1bWVudC5yZWFkeVN0YXRlOyB9KSgpJztcbiAgICBsZXQgcmVhZHlTdGF0ZSA9ICdsb2FkaW5nJztcbiAgICB0cnkge1xuICAgICAgcmVhZHlTdGF0ZSA9IGF3YWl0IEIucmVzb2x2ZSh0aGlzLmV4ZWN1dGUocmVhZHlDbWQsIHRydWUpKS50aW1lb3V0KHRoaXMucGFnZVJlYWR5VGltZW91dCk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBpZiAoIShlcnIgaW5zdGFuY2VvZiBCLlRpbWVvdXRFcnJvcikpIHtcbiAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgfVxuICAgICAgbG9nLmRlYnVnKGBQYWdlIHJlYWRpbmVzcyBjaGVjayB0aW1lZCBvdXQgYWZ0ZXIgJHt0aGlzLnBhZ2VSZWFkeVRpbWVvdXR9bXNgKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgbG9nLmRlYnVnKGBEb2N1bWVudCByZWFkeVN0YXRlIGlzICcke3JlYWR5U3RhdGV9J2ApO1xuXG4gICAgcmV0dXJuIHJlYWR5U3RhdGUgPT09ICdjb21wbGV0ZSc7XG4gIH1cblxuICBhc3luYyBuYXZUb1VybCAodXJsLCBwYWdlTG9hZFZlcmlmeUhvb2spIHtcbiAgICAvLyBubyBuZWVkIHRvIGRvIHRoaXMgY2hlY2sgd2hlbiB1c2luZyB3ZWJraXRcbiAgICBpZiAodGhpcy5kZWJ1Z2dlclR5cGUgPT09IERFQlVHR0VSX1RZUEVTLndlYmluc3BlY3Rvcikge1xuICAgICAgY29uc3QgZXJyb3JzID0gY2hlY2tQYXJhbXMoe2FwcElkS2V5OiB0aGlzLmFwcElkS2V5LCBwYWdlSWRLZXk6IHRoaXMucGFnZUlkS2V5fSk7XG4gICAgICBpZiAoZXJyb3JzKSB0aHJvdyBuZXcgRXJyb3IoZXJyb3JzKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBjdXJseVxuICAgIH1cblxuICAgIHRoaXMuX25hdmlnYXRpbmdUb1BhZ2UgPSB0cnVlO1xuXG4gICAgdHJ5IHtcbiAgICAgIGxvZy5kZWJ1ZyhgTmF2aWdhdGluZyB0byBuZXcgVVJMOiAnJHt1cmx9J2ApO1xuICAgICAgYXdhaXQgdGhpcy5ycGNDbGllbnQuc2VuZCgnc2V0VXJsJywge1xuICAgICAgICB1cmwsXG4gICAgICAgIGFwcElkS2V5OiB0aGlzLmFwcElkS2V5LFxuICAgICAgICBwYWdlSWRLZXk6IHRoaXMucGFnZUlkS2V5LFxuICAgICAgICBkZWJ1Z2dlclR5cGU6IHRoaXMuZGVidWdnZXJUeXBlXG4gICAgICB9KTtcblxuICAgICAgaWYgKCF0aGlzLnVzZU5ld1NhZmFyaSkge1xuICAgICAgICAvLyBhIHNtYWxsIHBhdXNlIGZvciB0aGUgYnJvd3NlciB0byBjYXRjaCB1cFxuICAgICAgICBhd2FpdCBCLmRlbGF5KDEwMDApO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5kZWJ1Z2dlclR5cGUgPT09IERFQlVHR0VSX1RZUEVTLndlYmluc3BlY3Rvcikge1xuICAgICAgICBhd2FpdCB0aGlzLndhaXRGb3JGcmFtZU5hdmlnYXRlZCgpO1xuICAgICAgfVxuICAgICAgYXdhaXQgdGhpcy53YWl0Rm9yRG9tKERhdGUubm93KCksIHBhZ2VMb2FkVmVyaWZ5SG9vayk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHRoaXMuX25hdmlnYXRpbmdUb1BhZ2UgPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBhc3luYyB3YWl0Rm9yRnJhbWVOYXZpZ2F0ZWQgKCkge1xuICAgIHJldHVybiBhd2FpdCBuZXcgQihhc3luYyAocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBsb2cuZGVidWcoJ1dhaXRpbmcgZm9yIGZyYW1lIG5hdmlnYXRlZCBtZXNzYWdlLi4uJyk7XG4gICAgICBsZXQgc3RhcnRNcyA9IERhdGUubm93KCk7XG5cbiAgICAgIC8vIGFkZCBhIGhhbmRsZXIgZm9yIHRoZSBgUGFnZS5mcmFtZU5hdmlnYXRlZGAgbWVzc2FnZVxuICAgICAgLy8gZnJvbSB0aGUgcmVtb3RlIGRlYnVnZ2VyXG4gICAgICBsZXQgbmF2RXZlbnRMaXN0ZW5lciA9ICh2YWx1ZSkgPT4ge1xuICAgICAgICBsb2cuZGVidWcoYEZyYW1lIG5hdmlnYXRlZCBpbiAkeygoRGF0ZS5ub3coKSAtIHN0YXJ0TXMpIC8gMTAwMCl9IHNlYyBmcm9tIHNvdXJjZTogJHt2YWx1ZX1gKTtcbiAgICAgICAgaWYgKHRoaXMubmF2aWdhdGlvbkRlbGF5KSB7XG4gICAgICAgICAgdGhpcy5uYXZpZ2F0aW9uRGVsYXkuY2FuY2VsKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmVzb2x2ZSh2YWx1ZSk7XG4gICAgICB9O1xuICAgICAgdGhpcy5ycGNDbGllbnQuc2V0U3BlY2lhbE1lc3NhZ2VIYW5kbGVyKCdQYWdlLmZyYW1lTmF2aWdhdGVkJywgcmVqZWN0LCBuYXZFdmVudExpc3RlbmVyKTtcblxuICAgICAgLy8gdGltZW91dCwgaW4gY2FzZSByZW1vdGUgZGVidWdnZXIgZG9lc24ndCByZXNwb25kLFxuICAgICAgLy8gb3IgdGFrZXMgYSBsb25nIHRpbWVcbiAgICAgIGlmICghdGhpcy51c2VOZXdTYWZhcmkgfHwgdGhpcy5wYWdlTG9hZE1zID49IDApIHtcbiAgICAgICAgLy8gdXNlIHBhZ2VMb2FkTXMsIG9yIGEgc21hbGwgYW1vdW50IG9mIHRpbWVcbiAgICAgICAgbGV0IHRpbWVvdXQgPSB0aGlzLnVzZU5ld1NhZmFyaSA/IHRoaXMucGFnZUxvYWRNcyA6IDUwMDtcbiAgICAgICAgdGhpcy5uYXZpZ2F0aW9uRGVsYXkgPSB1dGlsLmNhbmNlbGxhYmxlRGVsYXkodGltZW91dCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgYXdhaXQgdGhpcy5uYXZpZ2F0aW9uRGVsYXk7XG4gICAgICAgICAgbmF2RXZlbnRMaXN0ZW5lcigndGltZW91dCcpO1xuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAvLyBub3RoaW5nIHRvIGRvOiB3ZSBvbmx5IGdldCBoZXJlIGlmIHRoZSByZW1vdGUgZGVidWdnZXJcbiAgICAgICAgICAvLyBhbHJlYWR5IG5vdGlmaWVkIG9mIGZyYW1lIG5hdmlnYXRpb24sIGFuZCB0aGUgZGVsYXlcbiAgICAgICAgICAvLyB3YXMgY2FuY2VsbGVkXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIHN0YXJ0VGltZWxpbmUgKGZuKSB7XG4gICAgbG9nLmRlYnVnKCdTdGFydGluZyB0byByZWNvcmQgdGhlIHRpbWVsaW5lJyk7XG4gICAgdGhpcy5ycGNDbGllbnQuc2V0VGltZWxpbmVFdmVudEhhbmRsZXIoZm4pO1xuICAgIHJldHVybiBhd2FpdCB0aGlzLnJwY0NsaWVudC5zZW5kKCdzdGFydFRpbWVsaW5lJywge1xuICAgICAgYXBwSWRLZXk6IHRoaXMuYXBwSWRLZXksXG4gICAgICBwYWdlSWRLZXk6IHRoaXMucGFnZUlkS2V5LFxuICAgICAgZGVidWdnZXJUeXBlOiB0aGlzLmRlYnVnZ2VyVHlwZVxuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgc3RvcFRpbWVsaW5lICgpIHtcbiAgICBsb2cuZGVidWcoJ1N0b3BwaW5nIHRvIHJlY29yZCB0aGUgdGltZWxpbmUnKTtcbiAgICBhd2FpdCB0aGlzLnJwY0NsaWVudC5zZW5kKCdzdG9wVGltZWxpbmUnLCB7XG4gICAgICBhcHBJZEtleTogdGhpcy5hcHBJZEtleSxcbiAgICAgIHBhZ2VJZEtleTogdGhpcy5wYWdlSWRLZXksXG4gICAgICBkZWJ1Z2dlclR5cGU6IHRoaXMuZGVidWdnZXJUeXBlXG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBzdGFydENvbnNvbGUgKGZuKSB7XG4gICAgbG9nLmRlYnVnKCdTdGFydGluZyB0byBsaXN0ZW4gZm9yIEphdmFTY3JpcHQgY29uc29sZScpO1xuICAgIHRoaXMucnBjQ2xpZW50LnNldENvbnNvbGVMb2dFdmVudEhhbmRsZXIoZm4pO1xuICAgIHJldHVybiBhd2FpdCB0aGlzLnJwY0NsaWVudC5zZW5kKCdzdGFydENvbnNvbGUnLCB7XG4gICAgICBhcHBJZEtleTogdGhpcy5hcHBJZEtleSxcbiAgICAgIHBhZ2VJZEtleTogdGhpcy5wYWdlSWRLZXksXG4gICAgICBkZWJ1Z2dlclR5cGU6IHRoaXMuZGVidWdnZXJUeXBlXG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBzdG9wQ29uc29sZSAoKSB7XG4gICAgbG9nLmRlYnVnKCdTdG9wcGluZyB0byBsaXN0ZW4gZm9yIEphdmFTY3JpcHQgY29uc29sZScpO1xuICAgIGF3YWl0IHRoaXMucnBjQ2xpZW50LnNlbmQoJ3N0b3BDb25zb2xlJywge1xuICAgICAgYXBwSWRLZXk6IHRoaXMuYXBwSWRLZXksXG4gICAgICBwYWdlSWRLZXk6IHRoaXMucGFnZUlkS2V5LFxuICAgICAgZGVidWdnZXJUeXBlOiB0aGlzLmRlYnVnZ2VyVHlwZVxuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgc3RhcnROZXR3b3JrIChmbikge1xuICAgIGxvZy5kZWJ1ZygnU3RhcnRpbmcgdG8gbGlzdGVuIGZvciBuZXR3b3JrIGV2ZW50cycpO1xuICAgIHRoaXMucnBjQ2xpZW50LnNldE5ldHdvcmtMb2dFdmVudEhhbmRsZXIoZm4pO1xuICAgIHJldHVybiBhd2FpdCB0aGlzLnJwY0NsaWVudC5zZW5kKCdzdGFydE5ldHdvcmsnLCB7XG4gICAgICBhcHBJZEtleTogdGhpcy5hcHBJZEtleSxcbiAgICAgIHBhZ2VJZEtleTogdGhpcy5wYWdlSWRLZXksXG4gICAgICBkZWJ1Z2dlclR5cGU6IHRoaXMuZGVidWdnZXJUeXBlXG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBzdG9wTmV0d29yayAoKSB7XG4gICAgbG9nLmRlYnVnKCdTdG9wcGluZyB0byBsaXN0ZW4gZm9yIG5ldHdvcmsgZXZlbnRzJyk7XG4gICAgYXdhaXQgdGhpcy5ycGNDbGllbnQuc2VuZCgnc3RvcE5ldHdvcmsnLCB7XG4gICAgICBhcHBJZEtleTogdGhpcy5hcHBJZEtleSxcbiAgICAgIHBhZ2VJZEtleTogdGhpcy5wYWdlSWRLZXksXG4gICAgICBkZWJ1Z2dlclR5cGU6IHRoaXMuZGVidWdnZXJUeXBlXG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBleGVjdXRlIChjb21tYW5kLCBvdmVycmlkZSkge1xuICAgIC8vIGlmIHRoZSBwYWdlIGlzIG5vdCBsb2FkZWQgeWV0LCB3YWl0IGZvciBpdFxuICAgIGlmICh0aGlzLnBhZ2VMb2FkaW5nICYmICFvdmVycmlkZSkge1xuICAgICAgbG9nLmRlYnVnKCdUcnlpbmcgdG8gZXhlY3V0ZSBidXQgcGFnZSBpcyBub3QgbG9hZGVkLicpO1xuICAgICAgYXdhaXQgdGhpcy53YWl0Rm9yRG9tKCk7XG4gICAgfVxuXG4gICAgLy8gbm8gbmVlZCB0byBjaGVjayBlcnJvcnMgaWYgaXQgaXMgd2Via2l0XG4gICAgaWYgKHRoaXMuZGVidWdnZXJUeXBlID09PSBERUJVR0dFUl9UWVBFUy53ZWJpbnNwZWN0b3IpIHtcbiAgICAgIGxldCBlcnJvcnMgPSBjaGVja1BhcmFtcyh7YXBwSWRLZXk6IHRoaXMuYXBwSWRLZXksIHBhZ2VJZEtleTogdGhpcy5wYWdlSWRLZXl9KTtcbiAgICAgIGlmIChlcnJvcnMpIHRocm93IG5ldyBFcnJvcihlcnJvcnMpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIGN1cmx5XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuZ2FyYmFnZUNvbGxlY3RPbkV4ZWN1dGUpIHtcbiAgICAgIGF3YWl0IHRoaXMuZ2FyYmFnZUNvbGxlY3QoKTtcbiAgICB9XG5cbiAgICBsb2cuZGVidWcoYFNlbmRpbmcgamF2YXNjcmlwdCBjb21tYW5kICR7Xy50cnVuY2F0ZShjb21tYW5kLCB7bGVuZ3RoOiA1MH0pfWApO1xuICAgIGxldCByZXMgPSBhd2FpdCB0aGlzLnJwY0NsaWVudC5zZW5kKCdzZW5kSlNDb21tYW5kJywge1xuICAgICAgY29tbWFuZCxcbiAgICAgIGFwcElkS2V5OiB0aGlzLmFwcElkS2V5LFxuICAgICAgcGFnZUlkS2V5OiB0aGlzLnBhZ2VJZEtleSxcbiAgICAgIGRlYnVnZ2VyVHlwZTogdGhpcy5kZWJ1Z2dlclR5cGUsXG4gICAgfSk7XG5cbiAgICByZXR1cm4gdGhpcy5jb252ZXJ0UmVzdWx0KHJlcyk7XG4gIH1cblxuICBhc3luYyBjYWxsRnVuY3Rpb24gKG9iaklkLCBmbiwgYXJncykge1xuICAgIGxldCBlcnJvcnMgPSBjaGVja1BhcmFtcyh7YXBwSWRLZXk6IHRoaXMuYXBwSWRLZXksIHBhZ2VJZEtleTogdGhpcy5wYWdlSWRLZXl9KTtcbiAgICBpZiAoZXJyb3JzKSB0aHJvdyBuZXcgRXJyb3IoZXJyb3JzKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBjdXJseVxuXG4gICAgaWYgKHRoaXMuZ2FyYmFnZUNvbGxlY3RPbkV4ZWN1dGUpIHtcbiAgICAgIGF3YWl0IHRoaXMuZ2FyYmFnZUNvbGxlY3QoKTtcbiAgICB9XG5cbiAgICBsb2cuZGVidWcoJ0NhbGxpbmcgamF2YXNjcmlwdCBmdW5jdGlvbicpO1xuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMucnBjQ2xpZW50LnNlbmQoJ2NhbGxKU0Z1bmN0aW9uJywge1xuICAgICAgb2JqSWQsXG4gICAgICBmbixcbiAgICAgIGFyZ3MsXG4gICAgICBhcHBJZEtleTogdGhpcy5hcHBJZEtleSxcbiAgICAgIHBhZ2VJZEtleTogdGhpcy5wYWdlSWRLZXksXG4gICAgICBkZWJ1Z2dlclR5cGU6IHRoaXMuZGVidWdnZXJUeXBlXG4gICAgfSk7XG5cbiAgICByZXR1cm4gdGhpcy5jb252ZXJ0UmVzdWx0KHJlcyk7XG4gIH1cblxuICBjb252ZXJ0UmVzdWx0IChyZXMpIHtcbiAgICBpZiAoXy5pc1VuZGVmaW5lZChyZXMpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYERpZCBub3QgZ2V0IE9LIHJlc3VsdCBmcm9tIHJlbW90ZSBkZWJ1Z2dlci4gUmVzdWx0IHdhczogJHtfLnRydW5jYXRlKHNpbXBsZVN0cmluZ2lmeShyZXMpLCB7bGVuZ3RoOiBSRVNQT05TRV9MT0dfTEVOR1RIfSl9YCk7XG4gICAgfSBlbHNlIGlmIChfLmlzU3RyaW5nKHJlcykpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHJlcyA9IEpTT04ucGFyc2UocmVzKTtcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAvLyB3ZSBtaWdodCBnZXQgYSBzZXJpYWxpemVkIG9iamVjdCwgYnV0IHdlIG1pZ2h0IG5vdFxuICAgICAgICAvLyBpZiB3ZSBnZXQgaGVyZSwgaXQgaXMganVzdCBhIHZhbHVlXG4gICAgICB9XG4gICAgfSBlbHNlIGlmICghXy5pc09iamVjdChyZXMpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFJlc3VsdCBoYXMgdW5leHBlY3RlZCB0eXBlOiAoJHt0eXBlb2YgcmVzfSkuYCk7XG4gICAgfVxuXG4gICAgaWYgKHJlcy5zdGF0dXMgJiYgcmVzLnN0YXR1cyAhPT0gMCkge1xuICAgICAgLy8gd2UgZ290IHNvbWUgZm9ybSBvZiBlcnJvci5cbiAgICAgIHRocm93IGVycm9yRnJvbUNvZGUocmVzLnN0YXR1cywgcmVzLnZhbHVlLm1lc3NhZ2UgfHwgcmVzLnZhbHVlKTtcbiAgICB9XG5cbiAgICAvLyB3aXRoIGVpdGhlciBoYXZlIGFuIG9iamVjdCB3aXRoIGEgYHZhbHVlYCBwcm9wZXJ0eSAoZXZlbiBpZiBgbnVsbGApLFxuICAgIC8vIG9yIGEgcGxhaW4gb2JqZWN0XG4gICAgcmV0dXJuIHJlcy5oYXNPd25Qcm9wZXJ0eSgndmFsdWUnKSA/IHJlcy52YWx1ZSA6IHJlcztcbiAgfVxuXG4gIGFsbG93TmF2aWdhdGlvbldpdGhvdXRSZWxvYWQgKGFsbG93ID0gdHJ1ZSkge1xuICAgIGlmIChfLmlzRnVuY3Rpb24odGhpcy5ycGNDbGllbnQuYWxsb3dOYXZpZ2F0aW9uV2l0aG91dFJlbG9hZCkpIHtcbiAgICAgIHRoaXMucnBjQ2xpZW50LmFsbG93TmF2aWdhdGlvbldpdGhvdXRSZWxvYWQoYWxsb3cpO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGdldENvb2tpZXMgKHVybHMpIHtcbiAgICBsb2cuZGVidWcoJ0dldHRpbmcgbmV0d29yayBjb29raWVzJyk7XG4gICAgcmV0dXJuIGF3YWl0IHRoaXMucnBjQ2xpZW50LnNlbmQoJ2dldENvb2tpZXMnLCB7XG4gICAgICBhcHBJZEtleTogdGhpcy5hcHBJZEtleSxcbiAgICAgIHBhZ2VJZEtleTogdGhpcy5wYWdlSWRLZXksXG4gICAgICBkZWJ1Z2dlclR5cGU6IHRoaXMuZGVidWdnZXJUeXBlLFxuICAgICAgdXJscyxcbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIGRlbGV0ZUNvb2tpZSAoY29va2llTmFtZSwgdXJsKSB7XG4gICAgbG9nLmRlYnVnKGBEZWxldGluZyBjb29raWUgJyR7Y29va2llTmFtZX0nIG9uICcke3VybH0nYCk7XG4gICAgcmV0dXJuIGF3YWl0IHRoaXMucnBjQ2xpZW50LnNlbmQoJ2RlbGV0ZUNvb2tpZScsIHtcbiAgICAgIGFwcElkS2V5OiB0aGlzLmFwcElkS2V5LFxuICAgICAgcGFnZUlkS2V5OiB0aGlzLnBhZ2VJZEtleSxcbiAgICAgIGRlYnVnZ2VyVHlwZTogdGhpcy5kZWJ1Z2dlclR5cGUsXG4gICAgICBjb29raWVOYW1lLFxuICAgICAgdXJsLFxuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgZ2FyYmFnZUNvbGxlY3QgKHRpbWVvdXRNcyA9IEdBUkJBR0VfQ09MTEVDVF9USU1FT1VUKSB7XG4gICAgbG9nLmRlYnVnKGBHYXJiYWdlIGNvbGxlY3Rpbmcgd2l0aCAke3RpbWVvdXRNc31tcyB0aW1lb3V0YCk7XG4gICAgY29uc3QgZXJyb3JzID0gY2hlY2tQYXJhbXMoe1xuICAgICAgYXBwSWRLZXk6IHRoaXMuYXBwSWRLZXksXG4gICAgICBwYWdlSWRLZXk6IHRoaXMucGFnZUlkS2V5LFxuICAgIH0pO1xuICAgIGlmIChlcnJvcnMpIHtcbiAgICAgIGxvZy5kZWJ1ZyhgVW5hYmxlIHRvIGNvbGxlY3QgZ2FyYmFnZSBhdCB0aGlzIHRpbWVgKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBhd2FpdCBCLnJlc29sdmUodGhpcy5ycGNDbGllbnQuc2VuZCgnZ2FyYmFnZUNvbGxlY3QnLCB7XG4gICAgICBhcHBJZEtleTogdGhpcy5hcHBJZEtleSxcbiAgICAgIHBhZ2VJZEtleTogdGhpcy5wYWdlSWRLZXksXG4gICAgICBkZWJ1Z2dlclR5cGU6IHRoaXMuZGVidWdnZXJUeXBlXG4gICAgfSkpLnRpbWVvdXQodGltZW91dE1zKVxuICAgIC50aGVuKGZ1bmN0aW9uIGdjU3VjY2VzcyAoKSB7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgcHJvbWlzZS9wcmVmZXItYXdhaXQtdG8tdGhlblxuICAgICAgbG9nLmRlYnVnKGBHYXJiYWdlIGNvbGxlY3Rpb24gc3VjY2Vzc2Z1bGApO1xuICAgIH0pLmNhdGNoKGZ1bmN0aW9uIGdjRXJyb3IgKGVycikgeyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIHByb21pc2UvcHJlZmVyLWF3YWl0LXRvLWNhbGxiYWNrc1xuICAgICAgaWYgKGVyciBpbnN0YW5jZW9mIEIuVGltZW91dEVycm9yKSB7XG4gICAgICAgIGxvZy5kZWJ1ZyhgR2FyYmFnZSBjb2xsZWN0aW9uIHRpbWVkIG91dCBhZnRlciAke3RpbWVvdXRNc31tc2ApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbG9nLmRlYnVnKGBVbmFibGUgdG8gY29sbGVjdCBnYXJiYWdlOiAke2Vyci5tZXNzYWdlfWApO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG5cbi8vIGV2ZW50IGVtaXR0ZWQgcHVibGljYWxseVxuUmVtb3RlRGVidWdnZXIuRVZFTlRfUEFHRV9DSEFOR0UgPSAncmVtb3RlX2RlYnVnZ2VyX3BhZ2VfY2hhbmdlJztcblJlbW90ZURlYnVnZ2VyLkVWRU5UX0ZSQU1FU19ERVRBQ0hFRCA9ICdyZW1vdGVfZGVidWdnZXJfZnJhbWVzX2RldGFjaGVkJztcblJlbW90ZURlYnVnZ2VyLkVWRU5UX0RJU0NPTk5FQ1QgPSAncmVtb3RlX2RlYnVnZ2VyX2Rpc2Nvbm5lY3QnO1xuXG4vLyBhZGQgZ2VuZXJpYyBjYWxsYmFja3NcbmZvciAoY29uc3QgW25hbWUsIGhhbmRsZXJdIG9mIF8udG9QYWlycyhtZXNzYWdlSGFuZGxlcnMpKSB7XG4gIFJlbW90ZURlYnVnZ2VyLnByb3RvdHlwZVtuYW1lXSA9IGhhbmRsZXI7XG59XG5cbmV4cG9ydCB7XG4gIFJlbW90ZURlYnVnZ2VyLCBERUJVR0dFUl9UWVBFUywgUkVNT1RFX0RFQlVHR0VSX1BPUlQsIFJQQ19SRVNQT05TRV9USU1FT1VUX01TLFxufTtcbiJdLCJmaWxlIjoibGliL3JlbW90ZS1kZWJ1Z2dlci5qcyIsInNvdXJjZVJvb3QiOiIuLi8uLiJ9
