"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

require("source-map-support/register");

var _simulatorXcode = _interopRequireDefault(require("./simulator-xcode-9"));

var _teen_process = require("teen_process");

const WEBINSPECTOR_SOCKET_REGEXP = /\s+(\S+com\.apple\.webinspectord_sim\.socket)/;

class SimulatorXcode93 extends _simulatorXcode.default {
  constructor(udid, xcodeVersion) {
    super(udid, xcodeVersion);
    this.webInspectorSocket = null;
  }

  async getWebInspectorSocket() {
    if (this.webInspectorSocket) {
      return this.webInspectorSocket;
    }

    let {
      stdout
    } = await (0, _teen_process.exec)('lsof', ['-aUc', 'launchd_sim']);

    for (let record of stdout.split('com.apple.CoreSimulator.SimDevice.')) {
      if (!record.includes(this.udid)) {
        continue;
      }

      const match = WEBINSPECTOR_SOCKET_REGEXP.exec(record);

      if (!match) {
        return null;
      }

      this.webInspectorSocket = match[1];
      return this.webInspectorSocket;
    }

    return null;
  }

}

var _default = SimulatorXcode93;
exports.default = _default;require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9zaW11bGF0b3IteGNvZGUtOS4zLmpzIl0sIm5hbWVzIjpbIldFQklOU1BFQ1RPUl9TT0NLRVRfUkVHRVhQIiwiU2ltdWxhdG9yWGNvZGU5MyIsIlNpbXVsYXRvclhjb2RlOSIsImNvbnN0cnVjdG9yIiwidWRpZCIsInhjb2RlVmVyc2lvbiIsIndlYkluc3BlY3RvclNvY2tldCIsImdldFdlYkluc3BlY3RvclNvY2tldCIsInN0ZG91dCIsInJlY29yZCIsInNwbGl0IiwiaW5jbHVkZXMiLCJtYXRjaCIsImV4ZWMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQUE7O0FBQ0E7O0FBSUEsTUFBTUEsMEJBQTBCLEdBQUcsK0NBQW5DOztBQUVBLE1BQU1DLGdCQUFOLFNBQStCQyx1QkFBL0IsQ0FBK0M7QUFDN0NDLEVBQUFBLFdBQVcsQ0FBRUMsSUFBRixFQUFRQyxZQUFSLEVBQXNCO0FBQy9CLFVBQU1ELElBQU4sRUFBWUMsWUFBWjtBQUVBLFNBQUtDLGtCQUFMLEdBQTBCLElBQTFCO0FBQ0Q7O0FBS0QsUUFBTUMscUJBQU4sR0FBK0I7QUFDN0IsUUFBSSxLQUFLRCxrQkFBVCxFQUE2QjtBQUMzQixhQUFPLEtBQUtBLGtCQUFaO0FBQ0Q7O0FBY0QsUUFBSTtBQUFDRSxNQUFBQTtBQUFELFFBQVcsTUFBTSx3QkFBSyxNQUFMLEVBQWEsQ0FBQyxNQUFELEVBQVMsYUFBVCxDQUFiLENBQXJCOztBQUNBLFNBQUssSUFBSUMsTUFBVCxJQUFtQkQsTUFBTSxDQUFDRSxLQUFQLENBQWEsb0NBQWIsQ0FBbkIsRUFBdUU7QUFDckUsVUFBSSxDQUFDRCxNQUFNLENBQUNFLFFBQVAsQ0FBZ0IsS0FBS1AsSUFBckIsQ0FBTCxFQUFpQztBQUMvQjtBQUNEOztBQUNELFlBQU1RLEtBQUssR0FBR1osMEJBQTBCLENBQUNhLElBQTNCLENBQWdDSixNQUFoQyxDQUFkOztBQUNBLFVBQUksQ0FBQ0csS0FBTCxFQUFZO0FBQ1YsZUFBTyxJQUFQO0FBQ0Q7O0FBQ0QsV0FBS04sa0JBQUwsR0FBMEJNLEtBQUssQ0FBQyxDQUFELENBQS9CO0FBQ0EsYUFBTyxLQUFLTixrQkFBWjtBQUNEOztBQUVELFdBQU8sSUFBUDtBQUNEOztBQXpDNEM7O2VBNENoQ0wsZ0IiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgU2ltdWxhdG9yWGNvZGU5IGZyb20gJy4vc2ltdWxhdG9yLXhjb2RlLTknO1xuaW1wb3J0IHsgZXhlYyB9IGZyb20gJ3RlZW5fcHJvY2Vzcyc7XG5cblxuLy8gaHR0cHM6Ly9yZWdleDEwMS5jb20vci9NRUw1NXQvMVxuY29uc3QgV0VCSU5TUEVDVE9SX1NPQ0tFVF9SRUdFWFAgPSAvXFxzKyhcXFMrY29tXFwuYXBwbGVcXC53ZWJpbnNwZWN0b3JkX3NpbVxcLnNvY2tldCkvO1xuXG5jbGFzcyBTaW11bGF0b3JYY29kZTkzIGV4dGVuZHMgU2ltdWxhdG9yWGNvZGU5IHtcbiAgY29uc3RydWN0b3IgKHVkaWQsIHhjb2RlVmVyc2lvbikge1xuICAgIHN1cGVyKHVkaWQsIHhjb2RlVmVyc2lvbik7XG5cbiAgICB0aGlzLndlYkluc3BlY3RvclNvY2tldCA9IG51bGw7XG4gIH1cblxuICAvKlxuICAgKiBAb3ZlcnJpZGVcbiAgICovXG4gIGFzeW5jIGdldFdlYkluc3BlY3RvclNvY2tldCAoKSB7XG4gICAgaWYgKHRoaXMud2ViSW5zcGVjdG9yU29ja2V0KSB7XG4gICAgICByZXR1cm4gdGhpcy53ZWJJbnNwZWN0b3JTb2NrZXQ7XG4gICAgfVxuXG4gICAgLy8gbHNvZiAtYVVjIGxhdW5jaGRfc2ltXG4gICAgLy8gZ2l2ZXMgYSBzZXQgb2YgcmVjb3JkcyBsaWtlOlxuICAgIC8vICAgbGF1bmNoZF9zIDY5NzYwIGlzYWFjICAgIDN1ICB1bml4IDB4NTdhYTRmY2VlYTM5MzdmMyAgICAgIDB0MCAgICAgIC9wcml2YXRlL3RtcC9jb20uYXBwbGUuQ29yZVNpbXVsYXRvci5TaW1EZXZpY2UuRDcwODJBNUMtMzRCNS00NzVDLTk5NEUtQTIxNTM0NDIzQjlFL3N5c2xvZ3NvY2tcbiAgICAvLyAgIGxhdW5jaGRfcyA2OTc2MCBpc2FhYyAgICA1dSAgdW5peCAweDU3YWE0ZmNlZWEzOTVmMDMgICAgICAwdDAgICAgICAvcHJpdmF0ZS90bXAvY29tLmFwcGxlLmxhdW5jaGQuMkIydThDa044Uy9MaXN0ZW5lcnNcbiAgICAvLyAgIGxhdW5jaGRfcyA2OTc2MCBpc2FhYyAgICA2dSAgdW5peCAweDU3YWE0ZmNlZWEzOTM3MmIgICAgICAwdDAgICAgICAtPjB4NTdhYTRmY2VlYTM5MzdmM1xuICAgIC8vICAgbGF1bmNoZF9zIDY5NzYwIGlzYWFjICAgIDh1ICB1bml4IDB4NTdhYTRmY2VlYTM5NTk4YiAgICAgIDB0MCAgICAgIC9wcml2YXRlL3RtcC9jb20uYXBwbGUubGF1bmNoZC4yajVrMVRNaDZpL2NvbS5hcHBsZS53ZWJpbnNwZWN0b3JkX3NpbS5zb2NrZXRcbiAgICAvLyAgIGxhdW5jaGRfcyA2OTc2MCBpc2FhYyAgICA5dSAgdW5peCAweDU3YWE0ZmNlZWEzOTRjNDMgICAgICAwdDAgICAgICAvcHJpdmF0ZS90bXAvY29tLmFwcGxlLmxhdW5jaGQuNHptOUpPOUtFcy9jb20uYXBwbGUudGVzdG1hbmFnZXJkLnVuaXgtZG9tYWluLnNvY2tldFxuICAgIC8vICAgbGF1bmNoZF9zIDY5NzYwIGlzYWFjICAgMTB1ICB1bml4IDB4NTdhYTRmY2VlYTM5NWYwMyAgICAgIDB0MCAgICAgIC9wcml2YXRlL3RtcC9jb20uYXBwbGUubGF1bmNoZC4yQjJ1OENrTjhTL0xpc3RlbmVyc1xuICAgIC8vICAgbGF1bmNoZF9zIDY5NzYwIGlzYWFjICAgMTF1ICB1bml4IDB4NTdhYTRmY2VlYTM5NTk4YiAgICAgIDB0MCAgICAgIC9wcml2YXRlL3RtcC9jb20uYXBwbGUubGF1bmNoZC4yajVrMVRNaDZpL2NvbS5hcHBsZS53ZWJpbnNwZWN0b3JkX3NpbS5zb2NrZXRcbiAgICAvLyAgIGxhdW5jaGRfcyA2OTc2MCBpc2FhYyAgIDEydSAgdW5peCAweDU3YWE0ZmNlZWEzOTRjNDMgICAgICAwdDAgICAgICAvcHJpdmF0ZS90bXAvY29tLmFwcGxlLmxhdW5jaGQuNHptOUpPOUtFcy9jb20uYXBwbGUudGVzdG1hbmFnZXJkLnVuaXgtZG9tYWluLnNvY2tldFxuICAgIC8vIHRoZXNlIF9hcHBlYXJfIHRvIGFsd2F5cyBiZSBncm91cGVkIHRvZ2V0aGVyIChzbywgdGhlIHJlY29yZHMgZm9yIHRoZSBwYXJ0aWN1bGFyIHNpbSBhcmUgYWxsIGluIGEgZ3JvdXAsIGJlZm9yZSB0aGUgbmV4dCBzaW0sIGV0Yy4pXG4gICAgLy8gc28gc3RhcnRpbmcgZnJvbSB0aGUgY29ycmVjdCBVRElELCB3ZSBvdWdodCB0byBiZSBhYmxlIHRvIHB1bGwgdGhlIG5leHQgcmVjb3JkIHdpdGggYGNvbS5hcHBsZS53ZWJpbnNwZWN0b3JkX3NpbS5zb2NrZXRgIHRvIGdldCB0aGUgY29ycmVjdCBzb2NrZXRcbiAgICBsZXQge3N0ZG91dH0gPSBhd2FpdCBleGVjKCdsc29mJywgWyctYVVjJywgJ2xhdW5jaGRfc2ltJ10pO1xuICAgIGZvciAobGV0IHJlY29yZCBvZiBzdGRvdXQuc3BsaXQoJ2NvbS5hcHBsZS5Db3JlU2ltdWxhdG9yLlNpbURldmljZS4nKSkge1xuICAgICAgaWYgKCFyZWNvcmQuaW5jbHVkZXModGhpcy51ZGlkKSkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IG1hdGNoID0gV0VCSU5TUEVDVE9SX1NPQ0tFVF9SRUdFWFAuZXhlYyhyZWNvcmQpO1xuICAgICAgaWYgKCFtYXRjaCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIHRoaXMud2ViSW5zcGVjdG9yU29ja2V0ID0gbWF0Y2hbMV07XG4gICAgICByZXR1cm4gdGhpcy53ZWJJbnNwZWN0b3JTb2NrZXQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgU2ltdWxhdG9yWGNvZGU5MztcbiJdLCJmaWxlIjoibGliL3NpbXVsYXRvci14Y29kZS05LjMuanMiLCJzb3VyY2VSb290IjoiLi4vLi4ifQ==
