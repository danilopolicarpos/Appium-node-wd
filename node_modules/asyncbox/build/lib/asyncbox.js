"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.sleep = sleep;
exports.retry = retry;
exports.nodeify = nodeify;
exports.nodeifyAll = nodeifyAll;
exports.retryInterval = retryInterval;
exports.asyncify = asyncify;
exports.parallel = parallel;
exports.asyncmap = asyncmap;
exports.asyncfilter = asyncfilter;
exports.waitForCondition = waitForCondition;

require("source-map-support/register");

var _bluebird = _interopRequireDefault(require("bluebird"));

var _es6Mapify = require("es6-mapify");

var _lodash = _interopRequireDefault(require("lodash"));

async function sleep(ms) {
  return await _bluebird.default.delay(ms);
}

async function retry(times, fn, ...args) {
  let tries = 0;
  let done = false;
  let res = null;

  while (!done && tries < times) {
    tries++;

    try {
      res = await fn(...args);
      done = true;
    } catch (err) {
      if (tries >= times) {
        throw err;
      }
    }
  }

  return res;
}

async function retryInterval(times, sleepMs, fn, ...args) {
  let count = 0;

  let wrapped = async () => {
    count++;
    let res;

    try {
      res = await fn(...args);
    } catch (e) {
      if (count !== times) {
        await sleep(sleepMs);
      }

      throw e;
    }

    return res;
  };

  return await retry(times, wrapped);
}

async function parallel(promises) {
  return await _bluebird.default.all(promises);
}

function nodeify(promisey, cb) {
  return _bluebird.default.resolve(promisey).nodeify(cb);
}

function nodeifyAll(promiseyMap) {
  let cbMap = {};

  for (const [name, fn] of (0, _es6Mapify.mapify)(promiseyMap)) {
    cbMap[name] = function (...args) {
      const _cb = args.slice(-1)[0];
      args = args.slice(0, -1);
      nodeify(fn(...args), _cb);
    };
  }

  return cbMap;
}

function asyncify(fn, ...args) {
  _bluebird.default.resolve(fn(...args)).done();
}

async function asyncmap(coll, mapper, runInParallel = true) {
  if (runInParallel) {
    return parallel(coll.map(mapper));
  }

  let newColl = [];

  for (let item of coll) {
    newColl.push((await mapper(item)));
  }

  return newColl;
}

async function asyncfilter(coll, filter, runInParallel = true) {
  let newColl = [];

  if (runInParallel) {
    let bools = await parallel(coll.map(filter));

    for (let i = 0; i < coll.length; i++) {
      if (bools[i]) {
        newColl.push(coll[i]);
      }
    }
  } else {
    for (let item of coll) {
      if (await filter(item)) {
        newColl.push(item);
      }
    }
  }

  return newColl;
}

async function waitForCondition(condFn, opts = {}) {
  _lodash.default.defaults(opts, {
    waitMs: 5000,
    intervalMs: 500
  });

  let debug = opts.logger ? opts.logger.debug.bind(opts.logger) : _lodash.default.noop;
  let begunAt = Date.now();
  let endAt = begunAt + opts.waitMs;

  let spin = async () => {
    const result = await condFn();

    if (result) {
      return result;
    }

    let now = Date.now();
    let waited = now - begunAt;

    if (now < endAt) {
      debug(`Waited for ${waited} ms so far`);
      await _bluebird.default.delay(opts.intervalMs);
      return await spin();
    }

    throw new Error(`Condition unmet after ${waited} ms. Timing out.`);
  };

  return await spin();
}require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9hc3luY2JveC5qcyJdLCJuYW1lcyI6WyJzbGVlcCIsIm1zIiwiQiIsImRlbGF5IiwicmV0cnkiLCJ0aW1lcyIsImZuIiwiYXJncyIsInRyaWVzIiwiZG9uZSIsInJlcyIsImVyciIsInJldHJ5SW50ZXJ2YWwiLCJzbGVlcE1zIiwiY291bnQiLCJ3cmFwcGVkIiwiZSIsInBhcmFsbGVsIiwicHJvbWlzZXMiLCJhbGwiLCJub2RlaWZ5IiwicHJvbWlzZXkiLCJjYiIsInJlc29sdmUiLCJub2RlaWZ5QWxsIiwicHJvbWlzZXlNYXAiLCJjYk1hcCIsIm5hbWUiLCJfY2IiLCJzbGljZSIsImFzeW5jaWZ5IiwiYXN5bmNtYXAiLCJjb2xsIiwibWFwcGVyIiwicnVuSW5QYXJhbGxlbCIsIm1hcCIsIm5ld0NvbGwiLCJpdGVtIiwicHVzaCIsImFzeW5jZmlsdGVyIiwiZmlsdGVyIiwiYm9vbHMiLCJpIiwibGVuZ3RoIiwid2FpdEZvckNvbmRpdGlvbiIsImNvbmRGbiIsIm9wdHMiLCJfIiwiZGVmYXVsdHMiLCJ3YWl0TXMiLCJpbnRlcnZhbE1zIiwiZGVidWciLCJsb2dnZXIiLCJiaW5kIiwibm9vcCIsImJlZ3VuQXQiLCJEYXRlIiwibm93IiwiZW5kQXQiLCJzcGluIiwicmVzdWx0Iiwid2FpdGVkIiwiRXJyb3IiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBRUE7O0FBQ0E7O0FBQ0E7O0FBRUEsZUFBZUEsS0FBZixDQUFzQkMsRUFBdEIsRUFBMEI7QUFDeEIsU0FBTyxNQUFNQyxrQkFBRUMsS0FBRixDQUFRRixFQUFSLENBQWI7QUFDRDs7QUFFRCxlQUFlRyxLQUFmLENBQXNCQyxLQUF0QixFQUE2QkMsRUFBN0IsRUFBaUMsR0FBR0MsSUFBcEMsRUFBMEM7QUFDeEMsTUFBSUMsS0FBSyxHQUFHLENBQVo7QUFDQSxNQUFJQyxJQUFJLEdBQUcsS0FBWDtBQUNBLE1BQUlDLEdBQUcsR0FBRyxJQUFWOztBQUNBLFNBQU8sQ0FBQ0QsSUFBRCxJ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O0FBQ0EsTUFBSUMsS0FBSyxHQUFHSCxPQUFPLEdBQUdULElBQUksQ0FBQ0csTUFBM0I7O0FBQ0EsTUFBSVUsSUFBSSxHQUFHLFlBQVk7QUFDckIsVUFBTUMsTUFBTSxHQUFHLE1BQU1mLE1BQU0sRUFBM0I7O0FBQ0EsUUFBSWUsTUFBSixFQUFZO0FBQ1YsYUFBT0EsTUFBUDtBQUNEOztBQUNELFFBQUlILEdBQUcsR0FBR0QsSUFBSSxDQUFDQyxHQUFMLEVBQVY7QUFDQSxRQUFJSSxNQUFNLEdBQUdKLEdBQUcsR0FBR0YsT0FBbkI7O0FBQ0EsUUFBSUUsR0FBRyxHQUFHQyxLQUFWLEVBQWlCO0FBQ2ZQLE1BQUFBLEtBQUssQ0FBRSxjQUFhVSxNQUFPLFlBQXRCLENBQUw7QUFDQSxZQUFNM0Qsa0JBQUVDLEtBQUYsQ0FBUTJDLElBQUksQ0FBQ0ksVUFBYixDQUFOO0FBQ0EsYUFBTyxNQUFNUyxJQUFJLEVBQWpCO0FBQ0Q7O0FBQ0QsVUFBTSxJQUFJRyxLQUFKLENBQVcseUJBQXdCRCxNQUFPLGtCQUExQyxDQUFOO0FBQ0QsR0FiRDs7QUFjQSxTQUFPLE1BQU1GLElBQUksRUFBakI7QUFDRCIsInNvdXJjZXNDb250ZW50IjpbIi8vIHRyYW5zcGlsZTptYWluXG5cbmltcG9ydCBCIGZyb20gJ2JsdWViaXJkJztcbmltcG9ydCB7IG1hcGlmeSB9IGZyb20gJ2VzNi1tYXBpZnknO1xuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJztcblxuYXN5bmMgZnVuY3Rpb24gc2xlZXAgKG1zKSB7XG4gIHJldHVybiBhd2FpdCBCLmRlbGF5KG1zKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gcmV0cnkgKHRpbWVzLCBmbiwgLi4uYXJncykge1xuICBsZXQgdHJpZXMgPSAwO1xuICBsZXQgZG9uZSA9IGZhbHNlO1xuICBsZXQgcmVzID0gbnVsbDtcbiAgd2hpbGUgKCFkb25lICYmIHRyaWVzIDwgdGltZXMpIHtcbiAgICB0cmllcysrO1xuICAgIHRyeSB7XG4gICAgICByZXMgPSBhd2FpdCBmbiguLi5hcmdzKTtcbiAgICAgIGRvbmUgPSB0cnVlO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgaWYgKHRyaWVzID49IHRpbWVzKSB7XG4gICAgICAgIHRocm93IGVycjtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIHJlcztcbn1cblxuYXN5bmMgZnVuY3Rpb24gcmV0cnlJbnRlcnZhbCAodGltZXMsIHNsZWVwTXMsIGZuLCAuLi5hcmdzKSB7XG4gIGxldCBjb3VudCA9IDA7XG4gIGxldCB3cmFwcGVkID0gYXN5bmMgKCkgPT4ge1xuICAgIGNvdW50Kys7XG4gICAgbGV0IHJlcztcbiAgICB0cnkge1xuICAgICAgcmVzID0gYXdhaXQgZm4oLi4uYXJncyk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgLy8gZG8gbm90IHBhdXNlIHdoZW4gZmluaXNoZWQgdGhlIGxhc3QgcmV0cnlcbiAgICAgIGlmIChjb3VudCAhPT0gdGltZXMpIHtcbiAgICAgICAgYXdhaXQgc2xlZXAoc2xlZXBNcyk7XG4gICAgICB9XG4gICAgICB0aHJvdyBlO1xuICAgIH1cbiAgICByZXR1cm4gcmVzO1xuICB9O1xuICByZXR1cm4gYXdhaXQgcmV0cnkodGltZXMsIHdyYXBwZWQpO1xufVxuXG5hc3luYyBmdW5jdGlvbiBwYXJhbGxlbCAocHJvbWlzZXMpIHtcbiAgcmV0dXJuIGF3YWl0IEIuYWxsKHByb21pc2VzKTtcbn1cblxuZnVuY3Rpb24gbm9kZWlmeSAocHJvbWlzZXksIGNiKSB7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgcHJvbWlzZS9wcmVmZXItYXdhaXQtdG8tY2FsbGJhY2tzXG4gIHJldHVybiBCLnJlc29sdmUocHJvbWlzZXkpLm5vZGVpZnkoY2IpO1xufVxuXG5mdW5jdGlvbiBub2RlaWZ5QWxsIChwcm9taXNleU1hcCkge1xuICBsZXQgY2JNYXAgPSB7fTtcbiAgZm9yIChjb25zdCBbbmFtZSwgZm5dIG9mIG1hcGlmeShwcm9taXNleU1hcCkpIHtcbiAgICBjYk1hcFtuYW1lXSA9IGZ1bmN0aW9uICguLi5hcmdzKSB7XG4gICAgICBjb25zdCBfY2IgPSBhcmdzLnNsaWNlKC0xKVswXTtcbiAgICAgIGFyZ3MgPSBhcmdzLnNsaWNlKDAsIC0xKTtcbiAgICAgIG5vZGVpZnkoZm4oLi4uYXJncyksIF9jYik7XG4gICAgfTtcbiAgfVxuICByZXR1cm4gY2JNYXA7XG59XG5cbmZ1bmN0aW9uIGFzeW5jaWZ5IChmbiwgLi4uYXJncykge1xuICBCLnJlc29sdmUoZm4oLi4uYXJncykpLmRvbmUoKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gYXN5bmNtYXAgKGNvbGwsIG1hcHBlciwgcnVuSW5QYXJhbGxlbCA9IHRydWUpIHtcbiAgaWYgKHJ1bkluUGFyYWxsZWwpIHtcbiAgICByZXR1cm4gcGFyYWxsZWwoY29sbC5tYXAobWFwcGVyKSk7XG4gIH1cblxuICBsZXQgbmV3Q29sbCA9IFtdO1xuICBmb3IgKGxldCBpdGVtIG9mIGNvbGwpIHtcbiAgICBuZXdDb2xsLnB1c2goYXdhaXQgbWFwcGVyKGl0ZW0pKTtcbiAgfVxuICByZXR1cm4gbmV3Q29sbDtcbn1cblxuYXN5bmMgZnVuY3Rpb24gYXN5bmNmaWx0ZXIgKGNvbGwsIGZpbHRlciwgcnVuSW5QYXJhbGxlbCA9IHRydWUpIHtcbiAgbGV0IG5ld0NvbGwgPSBbXTtcbiAgaWYgKHJ1bkluUGFyYWxsZWwpIHtcbiAgICBsZXQgYm9vbHMgPSBhd2FpdCBwYXJhbGxlbChjb2xsLm1hcChmaWx0ZXIpKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvbGwubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChib29sc1tpXSkge1xuICAgICAgICBuZXdDb2xsLnB1c2goY29sbFtpXSk7XG4gICAgICB9XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGZvciAobGV0IGl0ZW0gb2YgY29sbCkge1xuICAgICAgaWYgKGF3YWl0IGZpbHRlcihpdGVtKSkge1xuICAgICAgICBuZXdDb2xsLnB1c2goaXRlbSk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiBuZXdDb2xsO1xufVxuXG5hc3luYyBmdW5jdGlvbiB3YWl0Rm9yQ29uZGl0aW9uIChjb25kRm4sIG9wdHMgPSB7fSkge1xuICBfLmRlZmF1bHRzKG9wdHMsIHtcbiAgICB3YWl0TXM6IDUwMDAsXG4gICAgaW50ZXJ2YWxNczogNTAwLFxuICB9KTtcbiAgbGV0IGRlYnVnID0gb3B0cy5sb2dnZXIgPyBvcHRzLmxvZ2dlci5kZWJ1Zy5iaW5kKG9wdHMubG9nZ2VyKSA6IF8ubm9vcDtcbiAgbGV0IGJlZ3VuQXQgPSBEYXRlLm5vdygpO1xuICBsZXQgZW5kQXQgPSBiZWd1bkF0ICsgb3B0cy53YWl0TXM7XG4gIGxldCBzcGluID0gYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbmRGbigpO1xuICAgIGlmIChyZXN1bHQpIHtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIGxldCBub3cgPSBEYXRlLm5vdygpO1xuICAgIGxldCB3YWl0ZWQgPSBub3cgLSBiZWd1bkF0O1xuICAgIGlmIChub3cgPCBlbmRBdCkge1xuICAgICAgZGVidWcoYFdhaXRlZCBmb3IgJHt3YWl0ZWR9IG1zIHNvIGZhcmApO1xuICAgICAgYXdhaXQgQi5kZWxheShvcHRzLmludGVydmFsTXMpO1xuICAgICAgcmV0dXJuIGF3YWl0IHNwaW4oKTtcbiAgICB9XG4gICAgdGhyb3cgbmV3IEVycm9yKGBDb25kaXRpb24gdW5tZXQgYWZ0ZXIgJHt3YWl0ZWR9IG1zLiBUaW1pbmcgb3V0LmApO1xuICB9O1xuICByZXR1cm4gYXdhaXQgc3BpbigpO1xufVxuXG5leHBvcnQge1xuICBzbGVlcCwgcmV0cnksIG5vZGVpZnksIG5vZGVpZnlBbGwsIHJldHJ5SW50ZXJ2YWwsIGFzeW5jaWZ5LCBwYXJhbGxlbCxcbiAgYXN5bmNtYXAsIGFzeW5jZmlsdGVyLCB3YWl0Rm9yQ29uZGl0aW9uXG59O1xuIl0sImZpbGUiOiJsaWIvYXN5bmNib3guanMiLCJzb3VyY2VSb290IjoiLi4vLi4ifQ==
